System.register([],function(t,e){"use strict";return{execute:function(){var t=document.createElement("style");t.textContent='*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;background:#1a1a1a;color:#fff;margin:0;padding:20px;overflow-x:auto;overflow-y:auto}.dev-frame{width:844px;height:390px;background:#000;border-radius:25px;padding:8px;margin:20px auto;box-shadow:0 0 30px rgba(0,0,0,.8),inset 0 0 0 2px #333;position:relative;overflow:visible}.bracket-dev-frame{width:844px;height:390px;background:#000;border-radius:25px;padding:8px;margin:20px auto;box-shadow:0 0 30px rgba(0,0,0,.8),inset 0 0 0 2px #555;position:relative;overflow:hidden}.dev-frame:before{content:"📱 iPhone Landscape 844×390 - Development Frame";position:absolute;top:-35px;left:50%;transform:translate(-50%);font-size:12px;color:#888;white-space:nowrap}.dev-frame:after{content:"Safe Area";position:absolute;top:2px;left:2px;right:2px;bottom:2px;border:1px dashed rgba(255,215,0,.3);border-radius:20px;pointer-events:none;font-size:10px;color:rgba(255,215,0,.5);display:flex;align-items:flex-start;justify-content:flex-start;padding:4px 8px}.bracket-dev-frame:before{content:"📱 Tournament Bracket View - Development Frame";position:absolute;top:-35px;left:50%;transform:translate(-50%);font-size:12px;color:#888;white-space:nowrap}.bracket-dev-frame:after{content:"Bracket Safe Area";position:absolute;top:2px;left:2px;right:2px;bottom:2px;border:1px dashed rgba(0,255,255,.3);border-radius:20px;pointer-events:none;font-size:10px;color:rgba(0,255,255,.5);display:flex;align-items:flex-start;justify-content:flex-start;padding:4px 8px}.bracket-container-dev{height:374px;width:828px;margin:0;background:linear-gradient(135deg,#2a2a2a,#1a1a1a);border-radius:18px;overflow:auto;padding:12px}.container{display:grid;grid-template-columns:120px 1fr 120px;grid-template-rows:280px 94px;grid-template-areas:"loot battleground info" "bottom-left chat bottom-right";gap:0;padding:0;height:374px!important;width:828px;margin:0;background:linear-gradient(135deg,#2a2a2a,#1a1a1a);border-radius:18px;overflow:hidden!important}:root{--sidebar-width: 120px;--chat-height: 94px;--container-padding: 8px;--border-radius: 10px;--gap-size: 0px}.left-section{grid-area:loot;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}.battlefield-section{grid-area:battleground;width:100%;height:100%;display:flex;flex-direction:column}.right-section{grid-area:info;width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;background:rgba(255,0,0,.3);border:2px solid red}.info-panel{width:100%;height:100%;background:#000;border:none;overflow:hidden;display:flex;flex-direction:column}.bottom-left-section{grid-area:bottom-left;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:rgba(0,255,0,.3);border:2px solid green}.bottom-section{grid-area:chat;width:100%!important;height:100%!important;max-height:94px!important;display:flex!important;justify-content:center;align-items:stretch;background:rgba(0,0,255,.3);border:2px solid blue;overflow:hidden!important}.bottom-right-section{grid-area:bottom-right;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:rgba(255,255,0,.3);border:2px solid yellow}.black-box{width:100%;height:100%;background:#000;border:none}.exit-container{width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:#000}.exit-btn{background:linear-gradient(45deg,gold,#ffed4e,gold,#ff8c00);background-size:400% 400%;border:2px solid #fff700;color:#000;font-size:.5rem;font-weight:900;font-family:"serif";padding:6px 12px;border-radius:6px;cursor:pointer;transition:all .5s ease;text-shadow:0 0 10px rgba(255,215,0,.8),2px 2px 4px rgba(0,0,0,.3);box-shadow:0 0 30px rgba(255,215,0,.8),0 0 60px rgba(255,215,0,.4),inset 0 0 20px rgba(255,255,255,.3);animation:goldShimmer 3s ease-in-out infinite,exitPulse 2s ease-in-out infinite;letter-spacing:2px}.exit-btn:hover{background:linear-gradient(45deg,#ffed4e,gold,#ffed4e,orange);transform:scale(1.1);box-shadow:0 0 40px gold,0 0 80px rgba(255,215,0,.6),inset 0 0 25px rgba(255,255,255,.5);animation:goldShimmer 1.5s ease-in-out infinite,exitPulse 1s ease-in-out infinite}@keyframes exitPulse{0%,to{box-shadow:0 0 30px rgba(255,215,0,.8),0 0 60px rgba(255,215,0,.4),inset 0 0 20px rgba(255,255,255,.3)}50%{box-shadow:0 0 40px gold,0 0 80px rgba(255,215,0,.6),inset 0 0 30px rgba(255,255,255,.5)}}.exit-btn:active{transform:scale(.95)}.emoji-panel{width:100%;height:100%;background:#000;display:flex;flex-direction:column;overflow:hidden}.emoji-header{background:linear-gradient(45deg,gold,#ffed4e,gold);color:#000;padding:6px 8px;text-align:center;font-weight:700;font-size:.8rem;text-shadow:none;border-radius:0;width:100%;flex-shrink:0}.emoji-grid{flex:1;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:repeat(5,1fr);gap:2px;padding:4px;overflow:hidden}.emoji-btn{background:rgba(255,255,255,.1);border:1px solid rgba(255,215,0,.3);border-radius:4px;font-size:1rem;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;min-height:0;padding:4px}.emoji-btn:hover{background:rgba(255,215,0,.3);border-color:gold;transform:scale(1.1)}.emoji-btn:active{background:rgba(255,215,0,.5);transform:scale(.95)}.chat-mode-container{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#000;gap:8px;padding:8px}.chat-mode-btn{background:linear-gradient(135deg,gold,#ffed4e);border:2px solid #ffed4e;color:#000;font-size:.5rem;font-weight:700;font-family:Arial,sans-serif;padding:4px 6px;border-radius:6px;cursor:pointer;transition:all .3s ease;text-align:center;line-height:1.1;text-shadow:1px 1px 2px rgba(0,0,0,.3);box-shadow:0 4px 15px rgba(255,215,0,.4);width:90%}.chat-mode-btn:hover{background:linear-gradient(135deg,#ffed4e,gold);transform:scale(1.05);box-shadow:0 6px 20px rgba(255,215,0,.6)}.chat-mode-btn:active{transform:scale(.95)}.top-section{display:grid;grid-template-columns:1fr 2fr 1fr;align-items:flex-start;gap:4px;padding:4px 6px;position:absolute;top:0;left:0;right:0;height:25%;z-index:10;flex-shrink:0}.fighter-card{position:relative;padding:8px 6px;border-radius:2px;text-align:center;overflow:hidden;border:1px solid;box-shadow:0 1px 2px rgba(0,0,0,.3);transition:all .3s ease;font-size:.5em;height:60px;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:10px;background:rgba(0,0,0,.5)!important}.fighter-card-bg{position:absolute;top:0;left:0;right:0;bottom:0;opacity:.1;background:radial-gradient(circle at center,currentColor 0%,transparent 70%)}.left-fighter-card{border-color:#4a90e2;background:linear-gradient(135deg,rgba(74,144,226,.15),rgba(74,144,226,.05));color:#4a90e2}.left-fighter-card.daring-hero{border-color:#4a90e2;background:linear-gradient(135deg,rgba(74,144,226,.25),rgba(74,144,226,.1));color:#4a90e2;box-shadow:0 6px 25px rgba(74,144,226,.4)}.right-fighter-card{border-color:#e74c3c;background:linear-gradient(135deg,rgba(231,76,60,.15),rgba(231,76,60,.05));color:#e74c3c}.fighter-card.following{border-color:gold;background:linear-gradient(135deg,rgba(255,215,0,.25),rgba(255,215,0,.1));color:gold;transform:scale(1.03);box-shadow:0 8px 30px rgba(255,215,0,.4);animation:followingPulse 2s infinite}.fighter-card.tournament-winner{border-color:#e6e6fa;background:linear-gradient(135deg,rgba(230,230,250,.3),rgba(255,182,193,.3),rgba(173,216,230,.3),rgba(144,238,144,.3),rgba(255,255,224,.3));color:#fff;transform:scale(1.1);box-shadow:0 0 30px rgba(230,230,250,.8),0 0 60px rgba(255,182,193,.6),0 0 90px rgba(173,216,230,.4);animation:diamondShimmer 3s infinite;text-shadow:2px 2px 8px rgba(0,0,0,.8)}@keyframes diamondShimmer{0%,to{box-shadow:0 0 30px rgba(230,230,250,.8),0 0 60px rgba(255,182,193,.6),0 0 90px rgba(173,216,230,.4)}33%{box-shadow:0 0 30px rgba(255,182,193,.8),0 0 60px rgba(173,216,230,.6),0 0 90px rgba(144,238,144,.4)}66%{box-shadow:0 0 30px rgba(173,216,230,.8),0 0 60px rgba(144,238,144,.6),0 0 90px rgba(255,255,224,.4)}}@keyframes followingPulse{0%,to{box-shadow:0 8px 30px rgba(255,215,0,.4)}50%{box-shadow:0 8px 30px rgba(255,215,0,.6)}}.fighter-titles{font-size:.55rem;font-weight:500;text-shadow:1px 1px 2px rgba(0,0,0,.8);letter-spacing:.3px;margin-bottom:2px;position:relative;z-index:2;opacity:.9;font-style:italic;width:100%;text-align:center;line-height:1.1}.fighter-name-display{font-size:.9rem;font-weight:700;text-shadow:1px 1px 4px rgba(0,0,0,.8);letter-spacing:.5px;margin:1px 0;position:relative;z-index:2;width:100%;text-align:center;line-height:1.1;word-wrap:break-word;hyphens:auto}.fighter-title{font-size:.5rem;font-weight:600;text-transform:uppercase;letter-spacing:1.5px;opacity:.8;position:relative;z-index:2;width:100%;text-align:center;margin-top:5px}.center-info{text-align:center;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:10px;position:relative}.bottom-vs{position:absolute;bottom:-2px;left:50%;transform:translate(-50%);z-index:10}.bottom-vs .vs-display{font-size:1rem;font-weight:900;background:linear-gradient(45deg,gold,#ffed4e,gold,#ff8c00);background-size:400% 400%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 0 10px rgba(255,215,0,.8),0 0 20px rgba(255,215,0,.6),0 0 30px rgba(255,215,0,.4);letter-spacing:8px;padding:4px 12px;border-radius:8px 8px 0 0;border:2px solid #ffd700;border-bottom:none;box-shadow:0 -2px 8px rgba(0,0,0,.3)}.top-progress{position:absolute;top:10px;left:50%;transform:translate(-50%);z-index:10}.top-odds{position:absolute;top:50px;left:50%;transform:translate(-50%);z-index:10}.nameplate-vs-container{position:absolute;bottom:0;left:0;right:0;display:flex;align-items:end;z-index:10;padding:0 20px;gap:2px}.nameplate{background:linear-gradient(45deg,gold,#ffed4e,gold);border:2px solid #ffed4e;border-bottom:none;border-radius:8px 8px 0 0;padding:8px 16px;flex:1;text-align:center;box-shadow:0 -4px 15px rgba(255,215,0,.4)}.nameplate.left-nameplate{text-align:left;padding-left:20px}.nameplate.right-nameplate{text-align:right;padding-right:20px}.nameplate-name{font-size:1.1rem;font-weight:700;color:#000;text-shadow:1px 1px 2px rgba(255,255,255,.3);margin-bottom:2px}.nameplate-titles{font-size:.7rem;color:#333;font-weight:600;opacity:.8}.nameplate .fighter-health{position:absolute;bottom:-25px;left:50%;transform:translate(-50%);display:flex;gap:3px;z-index:15}.nameplate .health-diamond{width:12px;height:12px;background:linear-gradient(45deg,red,#f66);transform:rotate(45deg);border:1px solid #fff;box-shadow:0 2px 4px rgba(0,0,0,.4)}.nameplate .health-diamond.empty{background:linear-gradient(45deg,#333,#555);border-color:#666}.vs-display{font-size:1rem;font-weight:900;background:#000;color:gold;border:2px solid #ffed4e;border-bottom:none;border-radius:8px 8px 0 0;padding:8px 16px;min-width:60px;text-align:center;box-shadow:0 -4px 15px rgba(255,215,0,.4);letter-spacing:2px;text-shadow:0 0 10px rgba(255,215,0,.6);font-family:"serif"}.progress-container{position:relative}.odds-overhang{position:relative;margin-top:10px;z-index:15;background:linear-gradient(135deg,rgba(255,215,0,.9),rgba(255,140,0,.8));border:3px solid #ffd700;border-radius:15px;padding:10px 20px;box-shadow:0 5px 25px rgba(255,215,0,.6),0 0 30px rgba(255,215,0,.4),inset 0 2px 10px rgba(255,255,255,.3);backdrop-filter:blur(10px)}.odds-display{margin:0;text-align:center}.odds-label{font-size:1rem;background:linear-gradient(45deg,gold,#ffed4e);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:900;text-transform:uppercase;margin-bottom:5px;letter-spacing:3px;text-shadow:0 0 10px rgba(255,215,0,.5);font-family:"serif"}.crown-odds{font-size:.8rem;background:linear-gradient(45deg,gold,#ffed4e,#fff700,#ff8c00);background-size:400% 400%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:900;text-shadow:0 0 15px rgba(255,215,0,.8),0 0 25px rgba(255,215,0,.4),2px 2px 0px rgba(0,0,0,.8);letter-spacing:2px;animation:goldShimmer 2.5s ease-in-out infinite;font-family:"serif"}.fighter-info{display:flex;flex-direction:column;align-items:center;min-width:200px}.fighter-name{font-size:1.4rem;font-weight:700;color:gold;margin-bottom:8px;text-shadow:2px 2px 4px rgba(0,0,0,.8)}.fighter-stats{display:flex;gap:15px;font-size:.9rem}.progress-container{flex:1;max-width:500px;text-align:center;width:100%;margin:0 auto;display:flex;flex-direction:column;align-items:center;justify-content:center}.progress-label{font-size:.6rem;font-weight:900;background:linear-gradient(45deg,gold,#ffed4e,gold);background-size:400% 400%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:10px;letter-spacing:2px;text-transform:uppercase;text-shadow:0 0 15px rgba(255,215,0,.6);animation:goldShimmer 4s ease-in-out infinite;font-family:"serif"}.progress-bar{background:linear-gradient(145deg,#1a1a1a,#2a2a2a);border-radius:12px;height:20px;overflow:hidden;border:2px solid #ffd700;width:100%;max-width:600px;box-shadow:0 0 20px rgba(255,215,0,.3),inset 0 2px 10px rgba(0,0,0,.5),inset 0 -2px 10px rgba(255,255,255,.1);position:relative}.progress-segments{display:flex;height:100%}.progress-segment{flex:1;border-right:2px solid #ffd700;transition:all .4s ease;position:relative}.progress-segment:last-child{border-right:none}.progress-segment.completed.tier-gray{background:linear-gradient(135deg,gray,#a0a0a0,#606060);box-shadow:inset 0 2px 8px rgba(255,255,255,.3),0 0 10px rgba(128,128,128,.4)}.progress-segment.completed.tier-white{background:linear-gradient(135deg,#fff,#f8f8f8,#e0e0e0);box-shadow:inset 0 2px 8px rgba(255,255,255,.5),0 0 10px rgba(255,255,255,.6)}.progress-segment.completed.tier-green{background:linear-gradient(135deg,#00ff7f,#32cd32,#228b22);box-shadow:inset 0 2px 8px rgba(255,255,255,.3),0 0 10px rgba(0,255,127,.4)}.progress-segment.completed.tier-blue{background:linear-gradient(135deg,#4169e1,#1e90ff,#06c);box-shadow:inset 0 2px 8px rgba(255,255,255,.3),0 0 10px rgba(65,105,225,.4)}.progress-segment.completed.tier-purple{background:linear-gradient(135deg,#8a2be2,#9370db,#6a0dad);box-shadow:inset 0 2px 8px rgba(255,255,255,.3),0 0 10px rgba(138,43,226,.4)}.progress-segment.completed.tier-orange{background:linear-gradient(135deg,#ff8c00,orange,tomato);box-shadow:inset 0 2px 8px rgba(255,255,255,.3),0 0 10px rgba(255,140,0,.4)}.progress-segment.completed.tier-gold{background:linear-gradient(135deg,gold,#ffed4a,#daa520);box-shadow:inset 0 2px 8px rgba(255,255,255,.4),0 0 15px rgba(255,215,0,.6);animation:goldGlow 2s infinite ease-in-out}@keyframes goldGlow{0%,to{box-shadow:inset 0 2px 8px rgba(255,255,255,.4),0 0 15px rgba(255,215,0,.6)}50%{box-shadow:inset 0 2px 8px rgba(255,255,255,.6),0 0 25px rgba(255,215,0,.8)}}.progress-segment.current{background:linear-gradient(135deg,gold,#ffed4a,#f6e05e);animation:fancyPulse 1.5s infinite ease-in-out;box-shadow:inset 0 2px 8px rgba(255,255,255,.4),0 0 15px rgba(255,215,0,.6)}.progress-segment.remaining{background:linear-gradient(135deg,rgba(255,255,255,.05),rgba(255,255,255,.15));box-shadow:inset 0 2px 5px rgba(0,0,0,.3)}@keyframes fancyPulse{0%,to{transform:scale(1);box-shadow:inset 0 2px 8px rgba(255,255,255,.4),0 0 15px rgba(255,215,0,.6)}50%{transform:scale(1.02);box-shadow:inset 0 2px 8px rgba(255,255,255,.6),0 0 25px rgba(255,215,0,.8)}}.bracket-overlay{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1000;display:flex;align-items:center;justify-content:center;transition:opacity .3s ease,visibility .3s ease}.bracket-overlay.hidden{opacity:0;visibility:hidden}.bracket-overlay-background{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.3);z-index:-1}.bracket-overlay-content{position:relative;width:95%;height:95%;background:#1a1a2e;border:2px solid #ffd700;border-radius:8px;overflow:hidden;display:flex;flex-direction:column}.close-bracket-btn{background:#f44;border:none;color:#fff;width:30px;height:30px;border-radius:50%;font-size:18px;font-weight:700;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s ease;flex-shrink:0}.close-bracket-btn:hover{background:#f66}.fighter-sprite,.progress-segment,.bracket-match{will-change:transform,opacity;transform:translateZ(0)}@keyframes pulse{0%,to{opacity:1}50%{opacity:.6}}.arena-viewport{flex:1;background:linear-gradient(180deg,#0f3460,#16537e,#1a1a2e);border:none;border-radius:0;position:relative;overflow:hidden;box-shadow:none;transition:background 1s ease}.arena-viewport.castle{background:url(/images/backgrounds/castle_background.png)!important;background-size:cover!important;background-position:center bottom!important;background-repeat:no-repeat!important}.arena-viewport.forest{background:url(/images/backgrounds/japan_background.png)!important;background-size:cover!important;background-position:center bottom!important;background-repeat:no-repeat!important}.arena-viewport.desert{background:url(/images/backgrounds/desert_background.png)!important;background-size:cover!important;background-position:center bottom!important;background-repeat:no-repeat!important}.arena-viewport.mountain{background:url(/images/backgrounds/snow_background.png)!important;background-size:cover!important;background-position:center bottom!important;background-repeat:no-repeat!important}.arena-viewport.ships{background:url(/images/backgrounds/ships_background.png)!important;background-size:cover!important;background-position:center bottom!important;background-repeat:no-repeat!important}.fighter-left,.fighter-right{position:absolute;bottom:-10%!important;display:flex;flex-direction:column;align-items:center;width:25%}.fighter-left{left:0;transform:translate(-100%)}.fighter-right{right:0;transform:translate(100%)}.fighter-sprite{margin-top:2px;transform:scale(.8)!important}.fighter-sprite svg{filter:drop-shadow(2px 2px 4px rgba(0,0,0,.5))}.character-image{width:220px;height:280px;object-fit:contain;filter:drop-shadow(2px 2px 4px rgba(0,0,0,.5));transition:filter .3s ease}.win-chance{color:#0f0;font-weight:700}.crown-odds{color:gold}.tournament-victory{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;z-index:100;opacity:0}.victory-text{font-size:4rem;font-weight:700;background:linear-gradient(45deg,#e6e6fa,#ffb6c1,#add8e6,#90ee90,#ffffe0,#e6e6fa);background-size:200% 200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;animation:rainbowShift 3s infinite,victoryPulse 2s infinite;text-shadow:0 0 20px rgba(255,255,255,.5);margin-bottom:20px}.victory-winner-name{font-size:2.5rem;font-weight:700;color:#fff;text-shadow:0 0 10px rgba(230,230,250,.8),0 0 20px rgba(255,182,193,.6),0 0 30px rgba(173,216,230,.4);margin-bottom:10px;animation:winnerNameGlow 2s infinite}@keyframes rainbowShift{0%,to{background-position:0% 50%}50%{background-position:100% 50%}}@keyframes victoryPulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes victory-glow{0%{filter:brightness(1) drop-shadow(0 0 5px #ffd700)}50%{filter:brightness(1.3) drop-shadow(0 0 15px #ffd700)}to{filter:brightness(1) drop-shadow(0 0 5px #ffd700)}}@keyframes winnerNameGlow{0%,to{text-shadow:0 0 10px rgba(230,230,250,.8),0 0 20px rgba(255,182,193,.6),0 0 30px rgba(173,216,230,.4)}50%{text-shadow:0 0 15px rgba(255,182,193,1),0 0 30px rgba(173,216,230,.8),0 0 45px rgba(144,238,144,.6)}}.arena-controls{position:absolute;bottom:20px;left:50%;transform:translate(-50%);z-index:10}.battle-btn{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:100;background:linear-gradient(45deg,gold,#ffed4e,gold,#ff8c00);background-size:400% 400%;border:3px solid #fff700;color:#000;padding:6px 12px;font-size:.7rem;font-weight:900;font-family:"serif";letter-spacing:1px;text-transform:uppercase;border-radius:8px;cursor:pointer;transition:all .5s ease;box-shadow:0 0 30px rgba(255,215,0,.8),0 0 60px rgba(255,215,0,.4),inset 0 0 20px rgba(255,255,255,.3);text-shadow:0 0 10px rgba(255,215,0,.8),2px 2px 4px rgba(0,0,0,.3);animation:goldShimmer 3s ease-in-out infinite,buttonPulse 2s ease-in-out infinite}.battle-btn:hover{transform:translate(-50%,-50%) scale(1.05);box-shadow:0 0 40px gold,0 0 80px rgba(255,215,0,.6),inset 0 0 25px rgba(255,255,255,.5);animation:goldShimmer 1.5s ease-in-out infinite,buttonPulse 1s ease-in-out infinite}.battle-btn:disabled{background:#666;cursor:not-allowed;transform:translate(-50%,-50%);box-shadow:none;animation:none}.battle-status{position:absolute;top:70%;left:50%;transform:translate(-50%,-50%);z-index:99;color:gold;font-size:1.2rem;font-weight:700;text-align:center;text-shadow:2px 2px 4px rgba(0,0,0,.8);opacity:0;transition:opacity .3s ease}.middle-section{display:flex;gap:0px;margin:0}.battle-info{height:100%;padding:8px;background:transparent;border-radius:0;border:none;display:flex;align-items:center;justify-content:center;flex-shrink:0;text-align:center;margin-bottom:0}.chat-container{width:100%!important;height:100%!important;max-height:100%!important;background:rgba(0,0,0,.7);border-radius:0;border:none;overflow:hidden!important;display:flex!important;flex-direction:column!important;transition:all .3s ease;flex-shrink:0!important}.loot-container{height:100%;width:100%;background:url(/images/Loot/loot_room.png) rgba(0,0,0,.7);background-size:cover;background-position:bottom center;background-blend-mode:multiply;border-radius:0;border:none;overflow:hidden;display:flex;flex-shrink:0;flex-direction:column;justify-content:flex-start;align-items:stretch;position:relative;margin-top:0;padding:0}.loot-header{background:linear-gradient(45deg,gold,#ffed4e,gold);color:#000;padding:6px 8px;text-align:center;font-weight:700;font-size:.8rem;text-shadow:none;border-radius:0;width:100%;flex-shrink:0}.loot-description{background:rgba(255,215,0,.1);color:gold;padding:4px 6px;text-align:center;font-size:.5rem;line-height:1.2;border-bottom:1px solid rgba(255,215,0,.3);flex-shrink:0}.loot-chest-image{position:absolute;bottom:-10%;left:50%;transform:translate(-50%);width:300px;height:auto;max-height:320px;object-fit:contain;z-index:5}.loot-content{flex:1;display:flex;align-items:flex-end;justify-content:center;background:linear-gradient(135deg,rgba(139,69,19,.1),rgba(160,82,45,.1));padding:0}.treasure-chest{display:flex;align-items:flex-end;justify-content:center;transition:transform .3s ease;transform:scale(.31) scaleX(-1);position:relative;z-index:10;width:100%;height:auto}.treasure-chest:hover{transform:translateY(-3px) scale(.34) scaleX(-1);cursor:pointer}.treasure-chest svg{filter:drop-shadow(2px 2px 4px rgba(0,0,0,.5))}.chest-image{width:100%;height:100%;object-fit:contain;filter:drop-shadow(2px 2px 4px rgba(0,0,0,.5))}.progress-gem{transition:fill .5s ease,stroke .5s ease}.progress-gem.tier-gray{fill:gray;stroke:#666}.progress-gem.tier-white{fill:#fff;stroke:#ddd}.progress-gem.tier-green{fill:#0f0;stroke:#0c0}.progress-gem.tier-blue{fill:#0080ff;stroke:#06c}.progress-gem.tier-purple{fill:#8000ff;stroke:#60c}.progress-gem.tier-orange{fill:#ff8000;stroke:#c60}.progress-gem.tier-gold{fill:gold;stroke:#fc0}.bracket-container{background:rgba(0,0,0,.7);border-radius:10px;border:3px solid #ffd700;overflow:hidden;display:flex;flex-direction:column;height:100%;grid-column:1;z-index:20;position:relative;transition:all .3s ease}.bracket-container.collapsed{height:auto;min-height:auto}.chat-header{background:transparent;padding:10px;text-align:center;font-weight:700;font-size:.9rem;flex-shrink:0;color:gold}.chat-input-container{display:flex;gap:5px;padding:10px;background:rgba(0,0,0,.8);border-top:1px solid #444;flex-shrink:0}.chat-input{flex:1;padding:8px 12px;background:rgba(255,255,255,.1);border:1px solid #444;border-radius:5px;color:#fff;font-size:.8rem}.chat-input::placeholder{color:#888}.chat-input:focus{outline:none;border-color:gold;background:rgba(255,255,255,.15)}.send-chat-btn{background:gold;border:none;color:#000;padding:8px 15px;border-radius:5px;font-weight:700;font-size:.7rem;cursor:pointer;transition:all .2s ease}.send-chat-btn:hover{background:#fd0;transform:scale(1.05)}.bracket-header{background:gold;color:#000;padding:10px;font-weight:700;font-size:.9rem;display:flex;justify-content:space-between;align-items:center;cursor:pointer;user-select:none;transition:all .2s ease}.bracket-header:hover{background:#ffed4e}.bracket-header .accordion-toggle{display:none}.bracket-header.expanded .accordion-toggle{transform:rotate(0)}.bracket-zoom-controls{display:flex;align-items:center;gap:8px}.zoom-btn{background:#333;color:gold;border:1px solid #ffd700;border-radius:4px;width:24px;height:24px;font-size:14px;font-weight:700;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.zoom-btn:hover{background:gold;color:#333}#zoom-level{font-size:.8rem;font-weight:700;min-width:40px;text-align:center}.bracket-content{flex:1;transition:all .3s ease;overflow:hidden;max-height:300px;opacity:1;padding:10px;margin:0;border:none}.bracket-content.expanded{max-height:none;opacity:1;padding:inherit;margin:inherit;border:inherit}.bracket-viewport{flex:1;position:relative;overflow-x:hidden;overflow-y:auto;background:rgba(0,0,0,.2)}.bracket-viewport::-webkit-scrollbar{height:12px;background:rgba(64,64,64,.8)}.bracket-viewport::-webkit-scrollbar-track{background:rgba(64,64,64,.8);border-radius:6px}.bracket-viewport::-webkit-scrollbar-thumb{background:rgba(128,128,128,.9);border-radius:6px;border:1px solid rgba(64,64,64,.6)}.bracket-viewport::-webkit-scrollbar-thumb:hover{background:rgba(128,128,128,.9)}.bracket-display{padding:10px;font-size:.65rem;line-height:1.2;transform:scale(.5) translateZ(0);-webkit-overflow-scrolling:touch;transition:transform .3s ease;transform-origin:top left;width:max-content;height:max-content;overflow:visible;min-width:100%;min-height:100%}.bracket-slider-container{position:absolute;right:8px;top:50%;transform:translateY(-50%);width:16px;height:250px;background:rgba(64,64,64,.9);border-radius:8px;padding:12px 4px;border:1px solid #666;box-shadow:inset 0 2px 4px rgba(0,0,0,.5);z-index:30}.bracket-slider{width:220px;height:6px;background:#404040;border-radius:3px;outline:none;-webkit-appearance:none;transform:rotate(90deg);transform-origin:center;cursor:pointer}.bracket-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:18px;height:18px;background:#888;border-radius:50%;cursor:pointer;border:2px solid #666;box-shadow:0 2px 4px rgba(0,0,0,.3)}.bracket-slider::-moz-range-thumb{width:18px;height:18px;background:#888;border-radius:50%;cursor:pointer;border:2px solid #666}.bracket-tree{display:flex;flex-direction:row;gap:20px;width:100%;padding:15px;min-height:125px;justify-content:space-evenly;overflow-y:visible;align-items:flex-start;background:linear-gradient(135deg,rgba(255,215,0,.02),rgba(255,215,0,.05));border-radius:15px;border:1px solid rgba(255,215,0,.1)}.bracket-round{display:flex;flex-direction:column;min-width:200px;position:relative;align-items:center;flex-shrink:0}.bracket-round .bracket-matches{gap:15px}.bracket-round-title{background:linear-gradient(45deg,gold,#ffed4e,gold);background-size:400% 400%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:900;font-size:1rem;margin-bottom:20px;text-align:center;border-bottom:2px solid #ffd700}.bracket-round-title.active-round{animation:goldShimmer 2s ease-in-out infinite;box-shadow:0 0 15px rgba(255,215,0,.6);border-radius:8px;padding:8px 12px;background:linear-gradient(45deg,gold,#ffed4e,gold,#ffed4e)!important;background-size:400% 400%!important;-webkit-background-clip:padding-box!important;background-clip:padding-box!important;-webkit-text-fill-color:#000!important;color:#000!important;font-weight:900}.bracket-matches{display:flex;flex-direction:column;justify-content:center;align-items:center;flex-wrap:wrap;gap:15px;width:100%;min-height:auto;height:auto;padding:10px}.bracket-match{background:linear-gradient(135deg,rgba(255,255,255,.08),rgba(255,255,255,.03));border:2px solid rgba(255,215,0,.3);border-radius:10px;padding:12px;position:relative;min-width:140px;max-width:180px;min-height:60px;display:flex;flex-direction:column;justify-content:center;box-shadow:0 4px 15px rgba(0,0,0,.3),inset 0 1px 3px rgba(255,255,255,.1);transition:all .3s ease;backdrop-filter:blur(5px)}.bracket-match:hover{transform:scale(1.02);border-color:rgba(255,215,0,.6);box-shadow:0 6px 20px rgba(0,0,0,.4),0 0 25px rgba(255,215,0,.3),inset 0 1px 5px rgba(255,255,255,.2)}.bracket-match.completed{border-color:#0f0;background:rgba(0,255,0,.1)}.bracket-match.current{border-color:gold;background:rgba(255,215,0,.3);box-shadow:0 0 15px rgba(255,215,0,.5);animation:currentMatchPulse 2s infinite}.bracket-match.following-path{border-color:gold;background:rgba(255,215,0,.15)}@keyframes currentMatchPulse{0%,to{box-shadow:0 0 15px rgba(255,215,0,.5)}50%{box-shadow:0 0 25px rgba(255,215,0,.8)}}.bracket-participant{padding:2px 4px;margin:1px 0;border-radius:3px;background:rgba(255,255,255,.1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:.6rem}.bracket-participant.winner{background:rgba(0,255,0,.3);color:#0f0;font-weight:700}.bracket-participant.eliminated{background:rgba(255,0,0,.2);color:#f66;text-decoration:line-through;opacity:.7}.bracket-participant.following{background:rgba(255,215,0,.5);color:gold;font-weight:700;border:1px solid #ffd700;box-shadow:0 0 8px rgba(255,215,0,.4)}.bracket-bye{color:#888;font-style:italic;text-align:center;padding:10px;font-size:.55rem}.bracket-match.bye-match{border:1px solid #666;background:rgba(255,255,255,.02);padding:15px 8px;text-align:center}.bracket-participant.bye-winner{text-align:center;margin:0;padding:5px}.bracket-match.empty{border:1px dashed #333;background:rgba(0,0,0,.1);opacity:.5}.vs-separator{text-align:center;color:gold;font-weight:700;font-size:.5rem;margin:1px 0}.bracket-connector{position:absolute;right:-20px;top:50%;width:20px;height:2px;background:#666;transform:translateY(-1px)}.bracket-connector.active{background:gold;box-shadow:0 0 4px rgba(255,215,0,.6)}.bracket-winner-display{color:gold;font-weight:700;text-align:center;background:rgba(255,215,0,.2);border:2px solid #ffd700;border-radius:8px;padding:15px;margin:20px 0;font-size:.8rem;box-shadow:0 0 15px rgba(255,215,0,.3)}.chat-content{flex:1!important;display:flex!important;flex-direction:column!important;overflow:hidden!important;background:rgba(0,0,0,.5);min-height:0!important;max-height:100%!important;height:100%!important;position:relative}.chat-content:before{content:"";position:absolute;top:0;left:0;right:0;height:25px;background:linear-gradient(to bottom,rgba(0,0,0,.8),transparent);z-index:1;pointer-events:none}.chat-messages{flex:1!important;padding:25px 8px 8px;overflow-y:auto!important;overflow-x:hidden!important;font-size:.7rem;line-height:1.3;word-wrap:break-word;min-height:0!important;max-height:100%!important;height:0!important;transform:translateZ(0);-webkit-overflow-scrolling:touch}.chat-messages::-webkit-scrollbar{width:12px;background:rgba(64,64,64,.3)}.chat-messages::-webkit-scrollbar-track{background:rgba(32,32,32,.5);border-radius:6px}.chat-messages::-webkit-scrollbar-thumb{background:rgba(96,96,96,.8);border-radius:6px;border:1px solid rgba(64,64,64,.6)}.chat-messages::-webkit-scrollbar-thumb:hover{background:rgba(128,128,128,.9)}.chat-message{margin-bottom:3px;opacity:0;animation:fadeInMessage .5s ease forwards;padding:2px 0}.chat-username{color:#4a90e2;font-weight:700;font-size:.65rem}.chat-text{color:#ccc;font-size:.65rem}.chat-message.user-message{background:rgba(255,215,0,.1);border-left:3px solid #ffd700;padding-left:5px;margin:3px 0}.chat-username.user-username{color:gold;font-weight:700}.chat-text.user-text{color:#fff;font-weight:500}.chat-message.announcer-message{background:linear-gradient(135deg,rgba(255,215,0,.3),rgba(255,140,0,.2),rgba(255,215,0,.15));border:2px solid #ffd700;border-radius:12px;padding:10px 15px;margin:6px 0;box-shadow:0 4px 20px rgba(255,215,0,.5),0 0 30px rgba(255,215,0,.3),inset 0 1px 5px rgba(255,255,255,.2);animation:announceGlow 3s ease-in-out infinite;position:relative;overflow:hidden}.chat-username.announcer-username{background:linear-gradient(45deg,gold,#ffed4e,gold);background-size:400% 400%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:900;text-transform:uppercase;font-size:.8rem;letter-spacing:2px;text-shadow:0 0 10px rgba(255,215,0,.8);animation:goldShimmer 2s ease-in-out infinite;font-family:"serif"}.chat-text.announcer-text{color:#fff;font-weight:700;font-size:.85rem;text-shadow:0 0 8px rgba(255,255,255,.8),2px 2px 4px rgba(0,0,0,.5);letter-spacing:1px}.chat-message.combat-message{background:rgba(255,0,0,.1);border-left:3px solid #ff4444;padding-left:8px;margin:2px 0}.chat-text.combat-text{color:#f66;font-weight:700;font-size:.65rem}@keyframes fadeInMessage{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes fighterEntranceLeft{0%{transform:translate(-100%) scale(.8)}to{transform:translate(0) scale(.8)}}@keyframes fighterEntranceRight{0%{transform:translate(100%) scale(.8)}to{transform:translate(0) scale(.8)}}@keyframes fighterExit{0%{opacity:1;transform:scale(.8)}to{opacity:0;transform:scale(.4) translateY(20px)}}@keyframes winnerPose{0%,to{transform:scale(.8) rotate(0)}25%{transform:scale(.88) rotate(-5deg)}75%{transform:scale(.88) rotate(5deg)}}@keyframes swordSlash{0%{transform:rotate(0)}50%{transform:rotate(-45deg)}to{transform:rotate(0)}}.sword-slash{animation:swordSlash .5s ease-in-out}@media screen and (max-width: 400px){.container{display:grid;grid-template-columns:1fr;grid-template-rows:auto auto auto;gap:10px;padding:10px}.battlefield-section{grid-column:1;grid-row:1}.middle-section{grid-column:1;grid-row:2;display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}.battle-info{height:150px;grid-column:1}.loot-container{height:150px;width:100%;grid-column:2}.chat-container{grid-column:1;grid-row:3;width:100%;height:300px;margin-top:10px}.bottom-section{grid-column:1;grid-row:4;display:block;margin-top:10px}.bracket-container{width:100%}.arena-viewport{height:400px}.top-section{grid-template-columns:1fr;gap:10px;padding:10px;text-align:center}.center-info{order:-1}.fighter-card{min-height:30px;padding:6px}.fighter-left,.fighter-right{bottom:-10%!important}}@keyframes oddsUpdate{0%{transform:scale(1);background:rgba(0,0,0,.8)}50%{transform:scale(1.1);background:rgba(255,215,0,.3)}to{transform:scale(1);background:rgba(0,0,0,.8)}}.fighter-entrance-left{animation:fighterEntranceLeft 1s ease-out forwards}.fighter-entrance-right{animation:fighterEntranceRight 1s ease-out forwards}.fighter-exit{animation:fighterExit .8s ease-out forwards}.winner-pose{animation:winnerPose .6s ease-in-out infinite}.odds-update{animation:oddsUpdate .8s ease-out}.victory-center{position:absolute!important;left:50%!important;right:auto!important;bottom:20%!important;transform:translate(-50%)!important;z-index:100!important;animation:moveToCenter 2s ease-in-out forwards!important}.victory-crown{position:absolute;top:-80px;left:50%;transform:translate(-50%);font-size:3rem;color:gold;text-shadow:0 0 20px rgba(255,215,0,.8);opacity:0;animation:crownDescend 3s ease-out forwards;animation-delay:1s}.victor-text{position:absolute;top:30%;left:50%;transform:translate(-50%,-50%);font-size:4rem;font-weight:700;color:gold;text-shadow:0 0 30px rgba(255,215,0,1);opacity:0;animation:victorTextAppear 2s ease-out forwards;animation-delay:2s;z-index:50}.victory-nameplate{position:absolute;top:-120px;left:50%;transform:translate(-50%);background:linear-gradient(135deg,rgba(255,215,0,.9),rgba(255,215,0,.7));border:3px solid #ffd700;border-radius:15px;padding:10px 20px;text-align:center;box-shadow:0 0 25px rgba(255,215,0,.6);opacity:0;animation:nameplateAppear 2s ease-out forwards;animation-delay:2.5s}.victory-name{font-size:1.2rem;font-weight:700;color:#000;margin-bottom:5px}.victory-title{font-size:.9rem;color:#333;font-style:italic}@keyframes moveToCenter{0%{left:var(--start-position);transform:translate(var(--start-transform))}to{left:50%;transform:translate(-50%)}}@keyframes crownDescend{0%{top:-200px;opacity:0;transform:translate(-50%) scale(.5)}70%{opacity:1;transform:translate(-50%) scale(1.2)}to{top:-80px;opacity:1;transform:translate(-50%) scale(1)}}@keyframes victorTextAppear{0%{opacity:0;transform:translate(-50%,-50%) scale(.3)}50%{opacity:1;transform:translate(-50%,-50%) scale(1.2)}to{opacity:1;transform:translate(-50%,-50%) scale(1)}}@keyframes nameplateAppear{0%{opacity:0;transform:translate(-50%) translateY(-20px) scale(.8)}to{opacity:1;transform:translate(-50%) translateY(0) scale(1)}}.fighter-health{position:absolute;top:100%;left:50%;transform:translate(-50%);display:flex;gap:3px;z-index:10;margin-top:4px}.health-diamond{width:12px;height:12px;background:#f44;transform:rotate(45deg);box-shadow:0 0 8px rgba(255,68,68,.6);transition:all .3s ease}.health-diamond.lost{background:#333;box-shadow:none;opacity:.3}.fighter-attacking{animation:attackAnimation .8s ease-in-out}.fighter-attacking svg{animation:swordAttack .8s ease-in-out}.fighter-defending{animation:defendAnimation .5s ease-in-out}.fighter-defending svg{animation:swordDefend .5s ease-in-out}.fighter-hit{animation:hitAnimation .6s ease-in-out}.fighter-hit svg{animation:swordHit .6s ease-in-out}.fighter-crit-glow{animation:critGlow 2s ease-in-out}.fighter-miss{animation:missAnimation .5s ease-in-out}.fighter-miss svg{animation:swordMiss .5s ease-in-out}.fighter-block{animation:blockAnimation .6s ease-in-out}.fighter-block svg{animation:swordBlock .6s ease-in-out}.fighter-parry{animation:parryAnimation .8s ease-in-out}.fighter-parry svg{animation:swordParry .8s ease-in-out}.damage-number{position:absolute;top:-40px;left:50%;transform:translate(-50%) scale(.8);font-size:1.2rem;font-weight:700;color:#f44;text-shadow:0 0 10px rgba(255,68,68,1),0 0 20px rgba(255,68,68,.6);opacity:0;animation:damageNumber 2s ease-out forwards;z-index:20}.crit-number{position:absolute;top:-40px;left:50%;transform:translate(-50%) scale(.8);font-size:1.6rem;font-weight:700;color:red;text-shadow:0 0 30px rgba(255,0,0,1),0 0 60px rgba(255,0,0,.8);opacity:0;animation:critNumber 2.5s ease-out forwards;z-index:20}.attacker-damage-number{position:absolute;top:-20px;left:50%;transform:translate(-50%);font-size:4rem;font-weight:700;color:#fff;text-shadow:0 0 20px rgba(255,255,255,1),0 0 40px rgba(255,255,255,.6),2px 2px 4px rgba(0,0,0,.8);opacity:0;animation:attackerDamage 1.2s ease-out forwards;z-index:25}.attacker-crit-number{position:absolute;top:-30px;left:50%;transform:translate(-50%);font-size:5rem;font-weight:700;color:#fff;text-shadow:0 0 30px rgba(255,255,255,1),0 0 60px rgba(255,255,255,.8),3px 3px 6px rgba(0,0,0,.9);opacity:0;animation:attackerCritDamage 1.5s ease-out forwards;z-index:25}.attacker-name{position:absolute;top:-60px;left:50%;transform:translate(-50%);font-size:2rem;font-weight:700;color:#fff;text-shadow:0 0 20px rgba(255,255,255,.8),2px 2px 4px rgba(0,0,0,.9);opacity:0;animation:attackerNameFade 1.2s ease-out forwards;z-index:24}.block-text,.parry-text,.miss-text{position:absolute;top:-30px;left:50%;transform:translate(-50%);font-size:2.5rem;font-weight:700;text-shadow:0 0 20px rgba(255,255,255,1),0 0 40px rgba(255,255,255,.6);opacity:0;animation:combatText 2s ease-out forwards;z-index:20}.block-text{color:#4caf50;text-shadow:0 0 20px rgba(76,175,80,1),0 0 40px rgba(76,175,80,.6)}.parry-text{color:#ff9800;text-shadow:0 0 20px rgba(255,152,0,1),0 0 40px rgba(255,152,0,.6)}.miss-text{color:#9e9e9e;text-shadow:0 0 20px rgba(158,158,158,1),0 0 40px rgba(158,158,158,.6)}@keyframes attackAnimation{0%{transform:translate(0) scale(.8)}30%{transform:translate(50px) scale(.85)}60%{transform:translate(60px) scale(.88)}to{transform:translate(0) scale(.8)}}@keyframes defendAnimation{0%{transform:scale(.8) translateY(0)}30%{transform:scale(.68) translateY(5px)}70%{transform:scale(.72) translateY(3px)}to{transform:scale(.8) translateY(0)}}@keyframes hitAnimation{0%{transform:translate(0) translateY(0) scale(.8);filter:brightness(1)}20%{transform:translate(-25px) translateY(-10px) scale(.72);filter:brightness(2) hue-rotate(0deg)}40%{transform:translate(20px) translateY(10px) scale(.88);filter:brightness(1.8) hue-rotate(30deg)}60%{transform:translate(-10px) translateY(-5px) scale(.76);filter:brightness(1.5) hue-rotate(15deg)}to{transform:translate(0) translateY(0) scale(.8);filter:brightness(1)}}@keyframes missAnimation{0%{transform:rotate(0) scale(.8)}25%{transform:rotate(-8deg) scale(.76)}50%{transform:rotate(5deg) scale(.84)}75%{transform:rotate(-3deg) scale(.784)}to{transform:rotate(0) scale(.8)}}@keyframes blockAnimation{0%{transform:scale(.8) translateY(0);filter:brightness(1)}30%{transform:scale(.96) translateY(-10px);filter:brightness(1.3) drop-shadow(0 0 10px #4CAF50)}70%{transform:scale(.92) translateY(-5px);filter:brightness(1.2) drop-shadow(0 0 8px #4CAF50)}to{transform:scale(.8) translateY(0);filter:brightness(1)}}@keyframes parryAnimation{0%{transform:rotate(0) scale(.8);filter:brightness(1)}25%{transform:rotate(-20deg) scale(.92);filter:brightness(1.4) drop-shadow(0 0 15px #FF9800)}50%{transform:rotate(25deg) scale(.96);filter:brightness(1.5) drop-shadow(0 0 20px #FF9800)}75%{transform:rotate(-10deg) scale(.88);filter:brightness(1.3) drop-shadow(0 0 12px #FF9800)}to{transform:rotate(0) scale(.8);filter:brightness(1)}}@keyframes damageNumber{0%{opacity:0;transform:translate(-50%) translateY(0) scale(.5)}20%{opacity:1;transform:translate(-50%) translateY(-30px) scale(1.2)}80%{opacity:1;transform:translate(-50%) translateY(-50px) scale(1)}to{opacity:0;transform:translate(-50%) translateY(-70px) scale(.8)}}@keyframes critNumber{0%{opacity:0;transform:translate(-50%) translateY(0) scale(.3) rotate(-10deg)}15%{opacity:1;transform:translate(-50%) translateY(-40px) scale(1.5) rotate(5deg)}30%{opacity:1;transform:translate(-50%) translateY(-50px) scale(1.3) rotate(-2deg)}70%{opacity:1;transform:translate(-50%) translateY(-60px) scale(1.1) rotate(1deg)}to{opacity:0;transform:translate(-50%) translateY(-80px) scale(.9) rotate(0)}}@keyframes attackerDamage{0%{opacity:0;transform:translate(-50%) translateY(0) scale(.3)}25%{opacity:1;transform:translate(-50%) translateY(-20px) scale(1.3)}75%{opacity:1;transform:translate(-50%) translateY(-30px) scale(1.1)}to{opacity:0;transform:translate(-50%) translateY(-40px) scale(.8)}}@keyframes attackerCritDamage{0%{opacity:0;transform:translate(-50%) translateY(0) scale(.2) rotate(-15deg)}20%{opacity:1;transform:translate(-50%) translateY(-30px) scale(1.4) rotate(8deg)}40%{opacity:1;transform:translate(-50%) translateY(-40px) scale(1.2) rotate(-3deg)}80%{opacity:1;transform:translate(-50%) translateY(-50px) scale(1) rotate(1deg)}to{opacity:0;transform:translate(-50%) translateY(-60px) scale(.8) rotate(0)}}@keyframes attackerNameFade{0%{opacity:0;transform:translate(-50%) translateY(0) scale(.8)}15%{opacity:1;transform:translate(-50%) translateY(-10px) scale(1.1)}85%{opacity:1;transform:translate(-50%) translateY(-20px) scale(1)}to{opacity:0;transform:translate(-50%) translateY(-60px) scale(.8) rotate(0)}}@keyframes combatText{0%{opacity:0;transform:translate(-50%) scale(.5)}20%{opacity:1;transform:translate(-50%) scale(1.2)}to{opacity:0;transform:translate(-50%) scale(1)}}@keyframes swordAttack{0%{transform:rotate(0)}20%{transform:rotate(-30deg)}60%{transform:rotate(-80deg)}80%{transform:rotate(-85deg)}to{transform:rotate(0)}}@keyframes swordDefend{0%{transform:rotate(0) scale(.8)}30%{transform:rotate(-45deg) scale(.88)}70%{transform:rotate(-40deg) scale(.84)}to{transform:rotate(0) scale(.8)}}@keyframes swordHit{0%{transform:rotate(0) scale(.8);filter:brightness(1)}20%{transform:rotate(20deg) scale(.76);filter:brightness(1.5)}40%{transform:rotate(-15deg) scale(.84);filter:brightness(1.4)}60%{transform:rotate(10deg) scale(.784);filter:brightness(1.3)}to{transform:rotate(0) scale(.8);filter:brightness(1)}}@keyframes critGlow{0%{filter:drop-shadow(0 0 0px red)}25%{filter:drop-shadow(0 0 20px red)}50%{filter:drop-shadow(0 0 30px red)}75%{filter:drop-shadow(0 0 20px red)}to{filter:drop-shadow(0 0 0px red)}}@keyframes goldShimmer{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}@keyframes buttonPulse{0%{box-shadow:0 0 30px rgba(255,215,0,.8),0 0 60px rgba(255,215,0,.4),inset 0 0 20px rgba(255,255,255,.3)}50%{box-shadow:0 0 40px gold,0 0 80px rgba(255,215,0,.6),inset 0 0 30px rgba(255,255,255,.5)}to{box-shadow:0 0 30px rgba(255,215,0,.8),0 0 60px rgba(255,215,0,.4),inset 0 0 20px rgba(255,255,255,.3)}}@keyframes announceGlow{0%{box-shadow:0 4px 20px rgba(255,215,0,.5),0 0 30px rgba(255,215,0,.3),inset 0 1px 5px rgba(255,255,255,.2)}50%{box-shadow:0 6px 30px rgba(255,215,0,.8),0 0 50px rgba(255,215,0,.5),inset 0 1px 8px rgba(255,255,255,.4)}to{box-shadow:0 4px 20px rgba(255,215,0,.5),0 0 30px rgba(255,215,0,.3),inset 0 1px 5px rgba(255,255,255,.2)}}@keyframes swordMiss{0%{transform:rotate(0)}25%{transform:rotate(-50deg)}50%{transform:rotate(30deg)}75%{transform:rotate(-20deg)}to{transform:rotate(0)}}@keyframes swordBlock{0%{transform:rotate(0) scale(.8);filter:brightness(1)}30%{transform:rotate(-60deg) scale(.96);filter:brightness(1.5) drop-shadow(0 0 15px #4CAF50)}70%{transform:rotate(-55deg) scale(.92);filter:brightness(1.4) drop-shadow(0 0 12px #4CAF50)}to{transform:rotate(0) scale(.8);filter:brightness(1)}}@keyframes swordParry{0%{transform:rotate(0);filter:brightness(1)}15%{transform:rotate(-110deg);filter:brightness(1.6) drop-shadow(0 0 20px #FF9800)}30%{transform:rotate(70deg);filter:brightness(1.7) drop-shadow(0 0 25px #FF9800)}50%{transform:rotate(-50deg);filter:brightness(1.5) drop-shadow(0 0 18px #FF9800)}75%{transform:rotate(25deg);filter:brightness(1.3) drop-shadow(0 0 12px #FF9800)}to{transform:rotate(0);filter:brightness(1)}}\n/*$vite$:1*/',document.head.appendChild(t);class e{constructor(){this.totalParticipants=100,this.bracketSize=128,this.participants=[],this.bracket=[],this.currentRound=1,this.currentMatch=0,this.followingCharacter="Daring Hero",this.heroAlive=!0,this.characterVisualSides={},this.winners=new Set,this.heroNames=["Daring Hero","Sir Clumsy","Lord Butterfingers","Duke Tripsalot","Baron Whoopsie","Count Mishap","Sir Fumbles","Lord Oopsington","Duke Derp","Sir Noodles","Baron Giggles","Count Wiggles","Lord Snuggles","Sir Pickles","Duke Waffles","Baron Pancakes","Count Muffins","Sir Tickles","Lord Chuckles","Duke Sparkles","Baron Dimples","Count Silly","Sir Wobbly","Lord Jiggly","Duke Squiggly","Captain Chaos","Sir Stumbles","Lord Blunders","Duke Mishief","Baron Bumbles","Count Giggleton","Sir Wigglebottom","Lord Snickerdoodle","Duke Ticklebottom","Baron Chucklehead","Count Dingleberry","Sir Noodlethwaite","Lord Bumblestorm","Duke Gigglesnort","Baron Wobbleshire","Count Ticklebeard","Sir Snugglesworth","Lord Pickleface","Duke Wafflebottom","Baron Pancakehead","Count Muffinshire","Sir Tickletoes","Lord Chuckleberry","Duke Sparklebottom","Baron Dimpleshire","Count Sillyhat","Sir Wobblesnort","Lord Jigglybottom","Duke Squigglebeard","Captain Clumsyface","Sir Stumblebum","Lord Blunderworth","Duke Mischiefmaker","Baron Bumblebee","Count Gigglesworth","Sir Wiggletail","Lord Snickerdorf","Duke Ticklemonster","Baron Chucklenuts","Count Dingleworth","Sir Noodleface","Lord Bumblesnort","Duke Gigglebeard","Baron Wobblehead","Count Tickleshire","Sir Snugglesnort","Lord Picklebottom","Duke Waffleface","Baron Pancakeworth","Count Muffinhead","Sir Ticklebottom","Lord Chuckleface","Duke Sparkletail","Baron Dimplesnort","Count Sillybeard","Sir Wobbleface","Lord Jigglesnort","Duke Squigglehead","Captain Clumsytail","Sir Stumbleface","Lord Blundersnort","Duke Mischiefbeard","Baron Bumblehead","Count Gigglesnort","Sir Wigglebottom","Lord Snickerbottom","Duke Tickleface","Baron Chuckletail","Count Dinglesnort","Sir Noodletail","Lord Bumblehead","Duke Giggleface","Baron Wobblesnort","Count Tickletail","Sir Snugglehead","Lord Pickletail","Duke Wafflesnort","Baron Pancakehead","Count Muffintail","Sir Ticklehead","Lord Chuckletail"],this.heroTitles={"Daring Hero":["The Brave","Destined for Glory"],"Sir Clumsy":["The Accident-Prone","Trip Master"],"Lord Butterfingers":["The Slippery","Dropper of Things"],"Duke Tripsalot":["The Unsteady","Gravity's Friend"],"Baron Whoopsie":["The Oops Master","Professional Mistake Maker"],"Count Mishap":["The Unfortunate","Calamity Caller"],"Sir Fumbles":["The Klutzy","Butter Hands"],"Lord Oopsington":["The Blunderer","Error Enthusiast"],"Duke Derp":["The Confused","Question Mark Incarnate"],"Sir Noodles":["The Floppy","Pasta Knight"],"Baron Giggles":["The Cheerful","Laughter Lord"],"Count Wiggles":["The Squirmy","Dance Master"],"Lord Snuggles":["The Cuddly","Hug Champion"],"Sir Pickles":["The Sour","Brine Knight"],"Duke Waffles":["The Crispy","Syrup Seeker"],"Baron Pancakes":["The Fluffy","Stack Master"],"Count Muffins":["The Crumbly","Bakery Baron"],"Sir Tickles":["The Giggle Inducer","Feather Fighter"],"Lord Chuckles":["The Amused","Joke Keeper"],"Duke Sparkles":["The Shiny","Glitter Guardian"],"Baron Dimples":["The Cute","Cheek Champion"],"Count Silly":["The Goofy","Nonsense Noble"],"Sir Wobbly":["The Unsteady","Jello Knight"],"Lord Jiggly":["The Bouncy","Wobble Warrior"],"Duke Squiggly":["The Wiggly","Noodle Noble"],"Captain Chaos":["The Disorderly","Mayhem Master"],"Sir Stumbles":["The Tumbler","Ground Kisser"],"Lord Blunders":["The Mistake Maker","Error Earl"],"Duke Mishief":["The Prankster","Trouble Starter"],"Baron Bumbles":["The Bee-like","Buzz Baron"],"Count Giggleton":["The Laughing","Chortle Champion"],"Sir Wigglebottom":["The Dancing Rear","Booty Bouncer"],"Lord Snickerdoodle":["The Cookie","Sweet Warrior"],"Duke Ticklebottom":["The Funny Rear","Giggle Glutes"],"Baron Chucklehead":["The Funny Faced","Grin Guardian"],"Count Dingleberry":["The Clingy","Awkward Attachment"],"Sir Noodlethwaite":["The Pasta Knight","Spaghetti Swordsman"],"Lord Bumblestorm":["The Clumsy Hurricane","Disaster Dancer"],"Duke Gigglesnort":["The Snorty Laugher","Chortle Champion"],"Baron Wobbleshire":["The Shaky County","Trembling Territory"],"Count Ticklebeard":["The Fuzzy Chin","Whisker Warrior"],"Sir Snugglesworth":["The Cuddly Knight","Hug Hero"],"Lord Pickleface":["The Sour Visage","Briny Baron"],"Duke Wafflebottom":["The Crispy Rear","Syrup Sitter"],"Baron Pancakehead":["The Flat Top","Stack Skull"],"Count Muffinshire":["The Baked County","Crumb Count"],"Sir Tickletoes":["The Giggly Feet","Toe Tickler"],"Lord Chuckleberry":["The Fruity Laugher","Berry Funny"],"Duke Sparklebottom":["The Shiny Rear","Glitter Glutes"],"Baron Dimpleshire":["The Cute County","Cheek Territory"],"Count Sillyhat":["The Goofy Headwear","Hat of Nonsense"],"Sir Wobblesnort":["The Shaky Snorter","Trembling Nose"],"Lord Jigglybottom":["The Bouncy Rear","Wiggly Warrior"],"Duke Squigglebeard":["The Wavy Whiskers","Curly Chin"],"Captain Clumsyface":["The Awkward Visage","Trip Captain"],"Sir Stumblebum":["The Professional Faller","Gravity's Victim"],"Lord Blunderworth":["The Noble Mistake","Error Earl"],"Duke Mischiefmaker":["The Trouble Creator","Prank Prince"],"Baron Bumblebee":["The Buzzing","Honey Hunter"],"Count Gigglesworth":["The Worthy Laugher","Noble Chuckler"],"Sir Wiggletail":["The Dancing Rear","Tail Wagger"],"Lord Snickerdorf":["The Cookie Village","Sweet Settlement"],"Duke Ticklemonster":["The Giggle Beast","Feather Fiend"],"Baron Chucklenuts":["The Nutty Laugher","Silly Snacker"],"Count Dingleworth":["The Worthy Clingy","Attachment Earl"],"Sir Noodleface":["The Pasta Visage","Spaghetti Skull"],"Lord Bumblesnort":["The Clumsy Snorter","Accident Nose"],"Duke Gigglebeard":["The Laughing Whiskers","Funny Facial Hair"],"Baron Wobblehead":["The Shaky Skull","Trembling Top"],"Count Tickleshire":["The Giggly County","Feather Territory"],"Sir Snugglesnort":["The Cuddly Snorter","Hug Nose"],"Lord Picklebottom":["The Sour Rear","Briny Bottom"],"Duke Waffleface":["The Crispy Visage","Syrup Skull"],"Baron Pancakeworth":["The Worthy Stack","Fluffy Noble"],"Count Muffinhead":["The Baked Brain","Crumbly Cranium"],"Sir Ticklebottom":["The Giggly Rear","Funny Bottom"],"Lord Chuckleface":["The Laughing Visage","Grinning Guardian"],"Duke Sparkletail":["The Shiny Rear","Glittery Bottom"],"Baron Dimplesnort":["The Cute Snorter","Adorable Nose"],"Count Sillybeard":["The Goofy Whiskers","Nonsense Facial Hair"],"Sir Wobbleface":["The Shaky Visage","Trembling Head"],"Lord Jigglesnort":["The Bouncy Snorter","Wiggly Nose"],"Duke Squigglehead":["The Wavy Brain","Curly Cranium"],"Captain Clumsytail":["The Awkward Rear","Trip Tail"],"Sir Stumbleface":["The Falling Visage","Gravity Face"],"Lord Blundersnort":["The Mistake Snorter","Error Nose"],"Duke Mischiefbeard":["The Trouble Whiskers","Prank Facial Hair"],"Baron Bumblehead":["The Buzzing Brain","Bee Skull"],"Count Gigglesnort":["The Laughing Snorter","Chortle Nose"],"Sir Wigglebottom":["The Dancing Rear","Booty Bouncer"],"Lord Snickerbottom":["The Cookie Rear","Sweet Bottom"],"Duke Tickleface":["The Giggly Visage","Feather Face"],"Baron Chuckletail":["The Laughing Rear","Funny Tail"],"Count Dinglesnort":["The Clingy Snorter","Attachment Nose"],"Sir Noodletail":["The Pasta Rear","Spaghetti Tail"],"Lord Bumblehead":["The Clumsy Brain","Accident Skull"],"Duke Giggleface":["The Laughing Visage","Chortle Head"],"Baron Wobblesnort":["The Shaky Snorter","Trembling Nose"],"Count Tickletail":["The Giggly Rear","Feather Tail"],"Sir Snugglehead":["The Cuddly Brain","Hug Head"],"Lord Pickletail":["The Sour Rear","Briny Tail"],"Duke Wafflesnort":["The Crispy Snorter","Syrup Nose"],"Baron Pancakehead":["The Flat Brain","Stack Skull"],"Count Muffintail":["The Baked Rear","Crumbly Tail"],"Sir Ticklehead":["The Giggly Brain","Feather Head"],"Lord Chuckletail":["The Laughing Rear","Funny Tail"]},this.initializeTournament()}getCharacterTitles(t){return this.heroTitles[t]||["The Unknown","Mystery Fighter"]}isWinner(t){return this.winners.has(t)}getDisplayOrder(){const t=this.getCurrentMatch();if(!t)return null;if(!(t.participant1 in this.characterVisualSides))if(t.participant2 in this.characterVisualSides){const e=this.characterVisualSides[t.participant2];this.characterVisualSides[t.participant1]="left"===e?"right":"left"}else this.characterVisualSides[t.participant1]="left";if(!(t.participant2 in this.characterVisualSides))if(t.participant1 in this.characterVisualSides){const e=this.characterVisualSides[t.participant1];this.characterVisualSides[t.participant2]="left"===e?"right":"left"}else this.characterVisualSides[t.participant2]="right";const e=this.characterVisualSides[t.participant1];let r,a;return this.characterVisualSides[t.participant2],"left"===e?(r=t.participant1,a=t.participant2):(r=t.participant2,a=t.participant1),{leftFighter:r,rightFighter:a,followedOnLeft:r===this.followingCharacter}}initializeTournament(){this.participants=[...this.heroNames.slice(0,this.totalParticipants)],this.followingCharacter="Daring Hero",this.heroAlive=!0,this.characterVisualSides={},this.winners=new Set;const t=this.participants.slice(1);this.shuffleArray(t),this.participants=["Daring Hero",...t],this.generateBracket()}shuffleArray(t){for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}}generateBracket(){this.bracket=[];const t=[];for(let r=0;r<this.bracketSize;r++)r<this.participants.length?t.push(this.participants[r]):t.push(null);this.bracket.push(t);let e=this.bracketSize/2;for(;e>=1;){const t=new Array(e).fill(null);this.bracket.push(t),e/=2}this.processInitialByes()}processInitialByes(){const t=this.bracket[0],e=this.bracket[1];for(let r=0;r<t.length;r+=2){const a=t[r],i=t[r+1],o=Math.floor(r/2);a&&!i?e[o]=a:!a&&i&&(e[o]=i)}}getCurrentMatch(){const t=this.bracket[this.currentRound-1];for(let e=0;e<t.length;e+=2){const r=t[e],a=t[e+1];if((r===this.followingCharacter||a===this.followingCharacter)&&r&&a)return{participant1:r,participant2:a,matchIndex:Math.floor(e/2),roundPosition:e}}return null}hasMatchToFight(){return null!==this.getCurrentMatch()}hasFollowedCharacterBye(){const t=this.bracket[this.currentRound-1];for(let e=0;e<t.length;e+=2){const r=t[e],a=t[e+1];if(r===this.followingCharacter&&!a)return{character:r,position:"left"};if(a===this.followingCharacter&&!r)return{character:a,position:"right"}}return null}battleResult(t){const e=this.getCurrentMatch();if(!e)return null;const r=this.getDisplayOrder(),a=t?r.leftFighter:r.rightFighter,i=t?r.rightFighter:r.leftFighter,o=i===this.followingCharacter;return this.currentRound<this.bracket.length&&(this.bracket[this.currentRound][e.matchIndex]=a),this.winners.add(a),o&&("Daring Hero"===this.followingCharacter&&(this.heroAlive=!1),this.followingCharacter=a),{winner:a,loser:i,followingChanged:o}}simulateRemainingMatches(){const t=this.bracket[this.currentRound-1];for(let e=0;e<t.length;e+=2){const r=t[e],a=t[e+1],i=Math.floor(e/2);if((r===this.followingCharacter||a===this.followingCharacter)&&r&&a)continue;if(this.bracket[this.currentRound][i]||!r||!a)continue;const o=Math.random()<.5?r:a;this.bracket[this.currentRound][i]=o}}advanceToNextMatch(){this.simulateRemainingMatches();const t=this.bracket[this.currentRound-1];let e=!0;for(let r=0;r<t.length;r+=2){const a=t[r],i=t[r+1],o=Math.floor(r/2);if(a&&i&&!this.bracket[this.currentRound][o]){e=!1;break}}e&&this.currentRound<this.bracket.length-1&&this.currentRound++}getRoundInfo(){const t=this.bracket.length-1;return{current:this.currentRound,total:t,name:["Round 1","Round 2","Round 3","Round 4","Round 5","Round 6","Quarterfinals","Semifinals","Final"][this.currentRound-1]||`Round ${this.currentRound}`,participantsLeft:this.bracket[this.currentRound-1].filter(t=>null!==t).length}}isComplete(){return this.currentRound>=this.bracket.length-1&&this.bracket[this.bracket.length-1][0]}getWinner(){return this.isComplete()?this.bracket[this.bracket.length-1][0]:null}}class r{constructor(){this.tournament=new e,this.currentOpponent="Random Fighter",this.tournamentStarted=!1,this.autoContinue=!1,this.battleInProgress=!1,this.knightImages=["Knight_01.png","Knight_02.png","Knight_03.png","knight_04.png","knight_05.png"],this.characterImageCache=new Map,this.allImages=[],this.imagesLoaded=!1,this.leftFighterHP=5,this.rightFighterHP=5,this.combatLog=[],this.currentTurn="left",this.combatRound=1,this.seed=this.generateSeed(),this.rng=this.createSeededRNG(this.seed),this.leftFighter=document.querySelector(".fighter-left"),this.rightFighter=document.querySelector(".fighter-right"),this.battleStatus=document.querySelector(".battle-status"),this.startButton=document.getElementById("start-battle"),this.chatMessages=document.getElementById("chat-messages"),this.arenaViewport=document.querySelector(".arena-viewport"),this.progressSegments=document.getElementById("progress-segments"),this.backgrounds=["castle","forest","desert","mountain","ships"],this.currentBgIndex=0,this.leftFighterNameEl=document.getElementById("left-nameplate-name"),this.rightFighterNameEl=document.getElementById("right-nameplate-name"),this.leftFighterTitlesEl=document.getElementById("left-nameplate-titles"),this.rightFighterTitlesEl=document.getElementById("right-nameplate-titles"),this.leftFighterCard=document.querySelector(".left-fighter-card"),this.rightFighterCard=document.querySelector(".right-fighter-card"),this.bracketDisplay=document.getElementById("bracket-display"),this.chatContainer=document.querySelector(".chat-container"),this.chatInput=document.getElementById("chat-input"),this.sendChatBtn=document.getElementById("send-chat"),this.bracketViewport=document.querySelector(".bracket-viewport"),this.bracketSlider=document.getElementById("bracket-slider"),this.zoomInBtn=document.getElementById("zoom-in"),this.zoomOutBtn=document.getElementById("zoom-out"),this.zoomLevel=document.getElementById("zoom-level"),this.currentZoom=1,this.currentScrollX=0,this.currentScrollY=0,this.chatLines=["TOURNAMENT BRACKET BATTLE!","WHO'S GONNA WIN?!","rip","GO HERO!","UPSET INCOMING","50/50 BABY","EPIC MEDIEVAL BATTLE","OMG OMG OMG","POGGERS","EZ CLAP","NO WAY","LUCKY","RNG GOD","SCRIPTED","RIGGED","CASTLE VIBES","FOREST FIGHT","DESERT DUEL","MOUNTAIN MAYHEM","BRACKET MADNESS","KEKW","LMAOOO","THIS IS NUTS","RNG IS CRAZY","SWORD GO BRRRR","SHEESH","BASED","CRACKED","BUILT DIFFERENT","NO CAP","FR FR","STONKS","DIAMOND HANDS","TO THE MOON","MONKE BRAIN","BANANA","SMOOTH BRAIN","BIG BRAIN","GALAXY BRAIN","SADGE","COPIUM","HOPIUM","MALDING","PEPEGA","PEPE LAUGH","OMEGALUL","5HEAD","ACTUALLY INSANE","UNREAL","ABSOLUTELY MENTAL","BONKERS","WILD","SICK PLAY","NUTTY","CRINGE","BASED AND REDPILLED","TOUCH GRASS","RATIO","L + RATIO","SKILL ISSUE","GET GOOD","NOOB","PRO GAMER MOVE","GAMER MOMENT","EPIC GAMER","LITERALLY SHAKING","I CAN'T EVEN","BRUH MOMENT","YEET","PERIODT","SUS","AMONGUS","IMPOSTOR","VENTING","EMERGENCY MEETING","RED SUS","MINECRAFT STEVE","FORTNITE BATTLE PASS","CHUNGUS","WHOLESOME 100","REDDIT MOMENT","SIMP","CHAD","VIRGIN VS CHAD","BASED CHAD","SIGMA MALE","ALPHA MOVE","BETA BEHAVIOR","MAIN CHARACTER ENERGY","NPC BEHAVIOR","CERTIFIED HOOD CLASSIC","HITS DIFFERENT","NO PRINTER","FACTS","SPITTING FACTS","PERIODT NO PRINTER","AND I OOP","SKSKSK","VSCO GIRL","OK BOOMER","ZOOMER ENERGY","MILLENNIAL HUMOR","GEN Z CHAOS","IT'S GIVING...","SLAY QUEEN","PERIODT BESTIE","NOT THE...","THE WAY I...","I'M DECEASED","STOP I'M CRYING","HELP-","BYE-","AKSJDHAKSJD","KEYBOARD SMASH","NO THOUGHTS HEAD EMPTY","BRAIN.EXE STOPPED","404 ERROR","WINDOWS XP SHUTDOWN","DIAL UP INTERNET","LOADING...","BUFFERING","LAG","PING DIFF","SKILLED PLAYER","UNSKILLED PLAYER"],this.byeMessages=["AUTOMATIC BYE!","ADVANCED WITHOUT FIGHTING","NO OPPONENT AVAILABLE!","LUCKY BRACKET PLACEMENT","FREE PASS TO NEXT ROUND","BRACKET BYE!"],this.winMessages=["WHAT A SWORD FIGHT!","INCREDIBLE BLADE WORK!","GGWP","CLEAN SWEEP","DEMOLISHED","BLADE MASTER!","SWORD LEGEND!","TOURNAMENT CONTINUES!","ADVANCING TO NEXT ROUND!"],this.init()}async init(){this.leftFighter&&this.rightFighter&&this.battleStatus&&this.startButton?(this.startButton.style.display="block",this.startButton.addEventListener("click",()=>this.startTournament()),this.preloadAllGraphics(),this.sendChatBtn&&this.sendChatBtn.addEventListener("click",()=>this.sendUserMessage()),this.chatInput&&this.chatInput.addEventListener("keypress",t=>{"Enter"===t.key&&this.sendUserMessage()}),this.startChatScroll(),this.updateOdds(),this.initProgressBar(),this.hideRightFighter(),this.arenaViewport.className=`arena-viewport ${this.backgrounds[this.currentBgIndex]}`,this.updateDisplay(),this.renderBracket(),this.initBracketControls(),this.initBracketOverlay(),this.initBracketAutoScroll(),this.initBracketAccordion()):console.error("Required DOM elements not found")}async preloadAllGraphics(){const t=[];this.knightImages.forEach(e=>{t.push(`images/Characters/${e}`)}),t.push("images/Characters/Daring_hero.png"),t.push("images/backgrounds/castle_background.png","images/backgrounds/japan_background.png","images/backgrounds/desert_background.png","images/backgrounds/snow_background.png","images/backgrounds/ships_background.png");const e=t.map(t=>this.loadImage(t));try{this.allImages=await Promise.all(e),this.imagesLoaded=!0,console.log("All graphics preloaded successfully")}catch(r){console.error("Error preloading graphics:",r),this.imagesLoaded=!0}}loadImage(t){return new Promise((e,r)=>{const a=new Image;a.onload=()=>e(a),a.onerror=()=>r(new Error(`Failed to load ${t}`)),a.src=t})}hideRightFighter(){this.rightFighter.style.opacity="0",this.rightFighterCard.style.opacity="0",this.rightFighterCard.style.transform="translateX(50px)"}showOpponentEntrance(){this.rightFighter.style.transition="opacity 1s ease, transform 1s ease",this.rightFighterCard.style.transition="opacity 1s ease, transform 1s ease",setTimeout(()=>{this.rightFighter.style.opacity="1",this.rightFighterCard.style.opacity="1",this.rightFighterCard.style.transform="translateX(0)"},500)}getCharacterImage(t){if("Daring Hero"===t)return"Daring_hero.png";if(!this.characterImageCache.has(t)){const e=Math.floor(Math.random()*this.knightImages.length);this.characterImageCache.set(t,this.knightImages[e])}return this.characterImageCache.get(t)}updateFighterSprite(t,e){const r=t.querySelector(".fighter-sprite");if(!r)return;const a=this.getCharacterImage(e),i=`./images/Characters/${a}`,o=t.classList.contains("fighter-left"),n=t.classList.contains("fighter-right"),s=o&&("knight_05.png"===a||"Knight_01.png"===a||"Knight_03.png"===a)||n&&"knight_04.png"===a?"transform: scale(0.8) scaleX(-1);":"transform: scale(0.8);";r.innerHTML=`<img src="${i}" alt="${e}" class="character-image" style="${s}">`}startTournament(){this.tournamentStarted?this.startBattle():(this.tournamentStarted=!0,this.autoContinue=!0,this.startButton.style.display="none",this.addChatMessage("TOURNAMENT BEGINS! DARING HERO VS THE WORLD!"),this.showOpponentEntrance(),setTimeout(()=>{this.startBattle()},1500))}startBattle(){const t=this.tournament.getCurrentMatch();if(!t)return void this.handleNoMatch();const e=this.tournament.hasFollowedCharacterBye();if(e)return void this.handleByeRound(e);const r=this.tournament.getRoundInfo();this.addAnnouncerMessage(`🎺 ${r.name.toUpperCase()} BEGINS! 🎺`),this.addAnnouncerMessage(`⚔️ ${t.participant1.toUpperCase()} VS ${t.participant2.toUpperCase()} ⚔️`),this.renderBracket(),setTimeout(()=>{this.scrollToCurrentMatch()},200),this.battleStatus.style.opacity="0",this.switchBackground(),this.resetFighters(),this.cleanupCombatElements(),this.updateMatchDisplay(t),setTimeout(()=>this.fighterEntrance(),500)}resetFighters(){this.leftFighter.className="fighter-left",this.rightFighter.className="fighter-right";const t=this.leftFighter.querySelector(".fighter-sprite"),e=this.rightFighter.querySelector(".fighter-sprite");t&&(t.style.animation=""),e&&(e.style.animation="")}fighterEntrance(){this.leftFighter.classList.add("fighter-entrance-left"),this.rightFighter.classList.add("fighter-entrance-right"),this.addChatMessage("FIGHTERS ENTER THE ARENA!"),this.addChatMessage("HERE WE GO!"),setTimeout(()=>this.executeFight(),2e3)}executeFight(){this.startCombat(),this.addChatMessage("TURN-BASED COMBAT BEGINS!"),this.addChatMessage("WATCH THE DICE ROLLS!")}resolveFight(t){const e=this.tournament.battleResult(t);if(!e)return;const r=this.tournament.getCurrentMatch(),a=this.tournament.getDisplayOrder();r&&a&&this.updateFighterCards(r,a);const i=t?this.leftFighter:this.rightFighter,o=t?this.rightFighter:this.leftFighter,n=i.querySelector(".fighter-sprite img");n&&(n.style.animation="victory-glow 1s ease-in-out"),setTimeout(()=>{o.classList.add("fighter-exit")},300),setTimeout(()=>{const t=i.querySelector(".fighter-sprite");t&&t.classList.add("winner-pose")},500),this.battleStatus.textContent=`${e.winner.toUpperCase()} WINS!`,this.addAnnouncerMessage(`🏆 ${e.winner.toUpperCase()} WINS! 🏆`),"Daring Hero"===e.loser&&(this.addAnnouncerMessage("💀 DARING HERO HAS BEEN ELIMINATED! 💀"),this.addAnnouncerMessage(`👑 NOW FOLLOWING ${e.winner.toUpperCase()}! 👑`)),this.addChatMessage(this.getRandomFromArray(this.winMessages)),this.addChatMessage("GG!"),setTimeout(()=>{this.tournament.advanceToNextMatch(),this.updateOdds(),this.updateProgressBar(),this.updateDisplay(),this.renderBracket(),setTimeout(()=>{this.scrollToCurrentMatch()},300),this.autoContinue&&!this.tournament.isComplete()?setTimeout(()=>this.startBattle(),2e3):this.enableRestart()},2e3)}updateOdds(){const t=`1 in ${this.tournament.getRoundInfo().participantsLeft.toLocaleString()}`,e=document.querySelector(".crown-odds");e&&(e.textContent=t)}enableRestart(){const t=this.tournament.getRoundInfo();if(this.startButton.disabled=!1,this.tournament.isComplete()){const t=this.tournament.getWinner();this.startButton.textContent=`${t.toUpperCase()} WINS THE CROWN!`,this.startButton.disabled=!0,this.addChatMessage("CROWN WINNER!"),this.addChatMessage("LEGENDARY!"),this.showVictoryAnimation(t)}else this.startButton.textContent=`CONTINUE ${t.name.toUpperCase()}`}startChatScroll(){this.chatMessages&&(this.addChatMessage("Welcome to RNG Arena!"),this.addChatMessage("Pure RNG battles await..."),this.chatScrollInterval=setInterval(()=>{this.startButton.disabled||this.addChatMessage(this.getRandomFromArray(this.chatLines))},800+1200*Math.random()))}addChatMessage(t){if(!this.chatMessages||!t)return;const e=document.createDocumentFragment(),r=document.createElement("div");r.className="chat-message";const a=this.generateRandomUsername();for(r.innerHTML=`\n            <span class="chat-username">${a}: ${t}</span>\n        `,e.appendChild(r),this.chatMessages.appendChild(e),requestAnimationFrame(()=>{this.chatMessages.scrollTop=this.chatMessages.scrollHeight});this.chatMessages.children.length>100;)this.chatMessages.removeChild(this.chatMessages.firstChild)}addAnnouncerMessage(t){if(!this.chatMessages||!t)return;const e=document.createElement("div");for(e.className="chat-message announcer-message",e.innerHTML=`\n            <span class="chat-username announcer-username">ANNOUNCER: ${t}</span>\n        `,this.chatMessages.appendChild(e),requestAnimationFrame(()=>{this.chatMessages.scrollTop=this.chatMessages.scrollHeight});this.chatMessages.children.length>100;)this.chatMessages.removeChild(this.chatMessages.firstChild)}addCombatMessage(t){if(!this.chatMessages||!t)return;const e=document.createElement("div");e.className="chat-message combat-message";let r=t;for(t.includes("blocks")&&(r=t.replace(/blocks/g,'<span style="color: #4CAF50; font-weight: bold;">blocks</span>')),t.includes("damage")&&(r=r.replace(/damage/g,'<span style="color: #ff4444; font-weight: bold;">damage</span>'),r=r.replace(/(\d+)(?=\s+damage)/g,'<span style="color: #ff6666; font-weight: bold;">$1</span>')),t.includes("CRIT")&&(r=r.replace(/CRIT/g,'<span style="color: #ff0000; font-weight: bold; text-shadow: 0 0 5px #ff0000;">CRIT</span>')),t.includes("critical")&&(r=r.replace(/critical/g,'<span style="color: #ff0000; font-weight: bold;">critical</span>')),t.includes("parries")&&(r=r.replace(/parries/g,'<span style="color: #FF9800; font-weight: bold;">parries</span>')),t.includes("misses")&&(r=r.replace(/misses/g,'<span style="color: #9E9E9E; font-weight: bold;">misses</span>')),e.innerHTML=`\n            <span class="chat-username">Combat: ${r}</span>\n        `,this.chatMessages.appendChild(e),requestAnimationFrame(()=>{this.chatMessages.scrollTop=this.chatMessages.scrollHeight});this.chatMessages.children.length>100;)this.chatMessages.removeChild(this.chatMessages.firstChild)}generateRandomUsername(){return`${this.getRandomFromArray(["RNG","Lucky","Fighter","Arena","Battle","Coin","Epic","Pro"])}${this.getRandomFromArray(["God","King","Master","Lord","2023","Pro","X","Legend"])}${Math.floor(999*Math.random())}`}getRandomFromArray(t){return t[Math.floor(Math.random()*t.length)]}switchBackground(){if(!this.arenaViewport)return;this.backgrounds.forEach(t=>{this.arenaViewport.classList.remove(t)});const t=this.backgrounds[this.currentBgIndex];this.arenaViewport.classList.add(t),this.currentBgIndex=(this.currentBgIndex+1)%this.backgrounds.length,this.addChatMessage({castle:"Welcome to the Castle Arena!",forest:"Fighting in the Forest Arena!",desert:"Battle in the Desert Arena!",mountain:"Combat in the Mountain Arena!"}[t])}updateDisplay(){const t=this.tournament.getCurrentMatch(),e=this.tournament.getDisplayOrder();this.updateFighterCards(t,e)}updateMatchDisplay(t){const e=this.tournament.getDisplayOrder();if(e){if(this.leftFighterNameEl&&(this.leftFighterNameEl.textContent=e.leftFighter,this.updateFighterSprite(this.leftFighter,e.leftFighter)),this.leftFighterTitlesEl){const t=this.tournament.getCharacterTitles(e.leftFighter);this.leftFighterTitlesEl.textContent=t.join(" • ")}if(this.rightFighterNameEl&&(this.rightFighterNameEl.textContent=e.rightFighter,this.updateFighterSprite(this.rightFighter,e.rightFighter),this.rightFighterTitlesEl)){const t=this.tournament.getCharacterTitles(e.rightFighter);this.rightFighterTitlesEl.textContent=t.join(" • ")}this.updateKnightColors(e.leftFighter,e.rightFighter),this.updateFighterCards(t,e)}}updateFighterCards(t,e){if(this.leftFighterCard.className="fighter-card left-fighter-card",this.rightFighterCard.className="fighter-card right-fighter-card",!t)return;const r=e?e.leftFighter:t.participant1,a=e?e.rightFighter:t.participant2;this.tournament.isWinner(r)?this.leftFighterCard.classList.add("following"):"Daring Hero"===r&&this.leftFighterCard.classList.add("daring-hero"),this.tournament.isWinner(a)?this.rightFighterCard.classList.add("following"):"Daring Hero"===a&&this.rightFighterCard.classList.add("daring-hero")}handleNoMatch(){this.addChatMessage("Tournament completed or no match available!"),this.enableRestart()}handleByeRound(t){this.battleStatus.textContent="BYE ROUND",this.battleStatus.style.opacity="1",this.addChatMessage("rest easy my friend and prepare for your next battle"),this.addChatMessage(`${t.character.toUpperCase()} ADVANCES AUTOMATICALLY!`),this.addChatMessage("NO OPPONENT AVAILABLE!"),this.updateByeDisplay(t),this.switchBackground(),setTimeout(()=>{this.tournament.advanceToNextMatch(),this.updateOdds(),this.updateProgressBar(),this.updateDisplay(),this.renderBracket(),this.autoContinue&&!this.tournament.isComplete()?setTimeout(()=>this.startBattle(),1500):this.enableRestart()},2e3)}updateByeDisplay(t){if("left"===t.position){this.leftFighterNameEl.textContent=t.character;const e=this.tournament.getCharacterTitles(t.character);this.leftFighterTitlesEl.textContent=e.join(" • "),this.updateFighterSprite(this.leftFighter,t.character),this.rightFighterNameEl.textContent="---",this.rightFighterTitlesEl.textContent="No Opponent";const r=this.rightFighter.querySelector(".fighter-sprite");r&&(r.innerHTML="")}else{this.rightFighterNameEl.textContent=t.character;const e=this.tournament.getCharacterTitles(t.character);this.rightFighterTitlesEl.textContent=e.join(" • "),this.updateFighterSprite(this.rightFighter,t.character),this.leftFighterNameEl.textContent="---",this.leftFighterTitlesEl.textContent="No Opponent";const r=this.leftFighter.querySelector(".fighter-sprite");r&&(r.innerHTML="")}const e={participant1:null,participant2:null};"left"===t.position?e.participant1=t.character:e.participant2=t.character,this.updateFighterCards(e,null)}showVictoryAnimation(t){const e=this.leftFighterNameEl.textContent,r=this.rightFighterNameEl.textContent;let a,i;if(e===t)a=this.leftFighter,i="left";else if(r===t)a=this.rightFighter,i="right";else{a=this.leftFighter,i="left",this.leftFighterNameEl.textContent=t;const e=this.tournament.getCharacterTitles(t);this.leftFighterTitlesEl.textContent=e.join(" • ")}("left"===i?this.rightFighter:this.leftFighter).style.opacity="0";const o="left"===i?"15%":"85%",n="left"===i?"0%":"-100%";a.style.setProperty("--start-position",o),a.style.setProperty("--start-transform",n),a.classList.add("victory-center");const s=a.querySelector(".fighter-sprite img");s&&(s.style.filter="drop-shadow(0 0 20px white) drop-shadow(0 0 40px white) drop-shadow(0 0 60px white)",s.style.animation="victory-glow 2s ease-in-out infinite"),setTimeout(()=>{const t=document.createElement("div");t.className="victory-crown",t.textContent="👑",a.appendChild(t)},1e3),setTimeout(()=>{const t=document.createElement("div");t.className="victor-text",t.textContent="VICTOR!",this.arenaViewport.appendChild(t)},2e3),setTimeout(()=>{const e=document.createElement("div");e.className="victory-nameplate";const r=this.tournament.getCharacterTitles(t);e.innerHTML=`\n                <div class="victory-name">${t}</div>\n                <div class="victory-title">${r.join(" • ")}</div>\n            `,a.appendChild(e)},2500),this.battleStatus.style.opacity="0"}generateSeed(){const t=this.tournament.getCurrentMatch();if(!t)return 12345;let e=0;const r=t.participant1+t.participant2;for(let a=0;a<r.length;a++)e=(e<<5)-e+r.charCodeAt(a)&4294967295;return Math.abs(e)||12345}createSeededRNG(t){let e=t;return function(){return e=16807*e%2147483647,(e-1)/2147483646}}rollDie(t){return Math.floor(this.rng()*t)+1}getMaxHPForRound(){const t=this.tournament.getRoundInfo().current;return t>=7?20:t>=6?12:t>=5?8:5}initHealthDisplays(){const t=document.querySelector(".left-nameplate");t&&t.querySelectorAll(".fighter-health").forEach(t=>t.remove());const e=this.getMaxHPForRound();this.createHealthDisplay(this.leftFighter,e),this.leftFighterHP=e,this.rightFighterHP=e,this.combatLog=[],this.currentTurn="left",this.combatRound=1,this.seed=this.generateSeed(),this.rng=this.createSeededRNG(this.seed)}createHealthDisplay(t,e){const r=document.createElement("div");r.className="fighter-health";for(let a=0;a<e;a++){const t=document.createElement("div");t.className="health-diamond",r.appendChild(t)}if(t.classList.contains("fighter-left")){const t=document.querySelector(".left-nameplate");t&&t.appendChild(r)}}updateHealthDisplay(t,e){if(!t.classList.contains("fighter-left"))return;const r=document.querySelector(".left-nameplate");if(!r)return;const a=r.querySelector(".fighter-health");a&&a.querySelectorAll(".health-diamond").forEach((t,r)=>{r>=e?t.classList.add("lost"):t.classList.remove("lost")})}startCombat(){this.initHealthDisplays(),this.battleStatus.textContent="COMBAT BEGINS!",this.battleStatus.style.opacity="1",setTimeout(()=>this.executeCombatBeat(),1e3)}executeCombatBeat(){const t="left"===this.currentTurn?"left":"right",e="left"===this.currentTurn?"right":"left",r="left"===t?this.leftFighter:this.rightFighter,a="left"===t?this.rightFighter:this.leftFighter,i="left"===t?this.leftFighterNameEl.textContent:this.rightFighterNameEl.textContent,o="left"===t?this.rightFighterNameEl.textContent:this.leftFighterNameEl.textContent,n=this.rollDie(6),s=5===n;this.addCombatAnimation(r,"fighter-attacking"),this.showCombatText(r,"ATTACK!","attacker-name"),setTimeout(()=>{if(6===n)this.handleMiss(r,i);else{const t=this.rollDie(7)+1;this.addCombatAnimation(a,"fighter-defending"),setTimeout(()=>{if(7===t)this.handleBlock(a,o,n,s);else if(8===t)this.handleParry(r,a,i,o,n,s);else{const t=s?7:n;this.handleHit(a,o,t,e,s)}},500)}},800)}handleMiss(t,e){this.addCombatAnimation(t,"fighter-miss"),this.showCombatText(t,"MISS!","miss-text");const r=`${e} attacks but misses!`;this.addCombatLog(r),this.addCombatMessage(`⚔️ ${e} swings and misses!`),this.nextTurn()}handleBlock(t,e,r,a){this.addCombatAnimation(t,"fighter-block"),this.showCombatText(t,"BLOCK!","block-text");const i=a?"CRIT":r.toString(),o=`${e} blocks ${i} damage!`;this.addCombatLog(o),this.addCombatMessage(`🛡️ ${e} blocks ${i} damage!`),this.nextTurn()}handleParry(t,e,r,a,i,o){this.addCombatAnimation(e,"fighter-parry"),this.showCombatText(e,"PARRY!","parry-text"),setTimeout(()=>{this.addCombatAnimation(t,"fighter-hit"),this.showDamageNumber(t,i,o),"left"==(t===this.leftFighter?"left":"right")?(this.leftFighterHP-=i,this.updateHealthDisplay(this.leftFighter,this.leftFighterHP)):this.rightFighterHP-=i;const e=o?"CRIT":i.toString(),n=`${a} parries and reflects ${e} damage back to ${r}!`;this.addCombatLog(n),this.addCombatMessage(`⚡ ${a} parries and reflects ${e} damage back to ${r}!`),this.leftFighterHP<=0||this.rightFighterHP<=0?this.endCombat():this.nextTurn()},800)}handleHit(t,e,r,a,i){const o="left"===a?this.rightFighter:this.leftFighter,n="left"===a?this.rightFighterNameEl.textContent:this.leftFighterNameEl.textContent;this.showAttackerDamage(o,r,i),setTimeout(()=>{this.addCombatAnimation(t,"fighter-hit"),i&&this.addCombatAnimation(t,"fighter-crit-glow"),this.showDamageNumber(t,r,i),"left"===a?(this.leftFighterHP-=r,this.updateHealthDisplay(this.leftFighter,this.leftFighterHP)):this.rightFighterHP-=r;const o=i?"CRIT":r.toString(),s=`${n} deals ${o} damage to ${e}!`;this.addCombatLog(s),this.addCombatMessage(`💀 ${n} deals ${o} damage to ${e}!`),this.leftFighterHP<=0||this.rightFighterHP<=0?this.endCombat():this.nextTurn()},800)}nextTurn(){this.currentTurn="left"===this.currentTurn?"right":"left",setTimeout(()=>{this.leftFighterHP>0&&this.rightFighterHP>0&&this.executeCombatBeat()},1500)}endCombat(){const t=this.rightFighterHP<=0,e=t?this.leftFighterNameEl.textContent:this.rightFighterNameEl.textContent,r=`${e} defeats ${t?this.rightFighterNameEl.textContent:this.leftFighterNameEl.textContent} with ${t?this.leftFighterHP:this.rightFighterHP} HP remaining!`;this.addCombatLog(r),this.battleStatus.textContent=`${e.toUpperCase()} WINS!`,setTimeout(()=>{this.resolveFight(t)},2e3)}addCombatAnimation(t,e){t.classList.add(e),setTimeout(()=>t.classList.remove(e),1e3)}showDamageNumber(t,e,r=!1){const a=document.createElement("div");a.className=r?"crit-number":"damage-number",a.textContent=r?"CRIT!":`-${e}`,t.appendChild(a),setTimeout(()=>a.remove(),r?2500:2e3)}showAttackerDamage(t,e,r=!1){const a=document.createElement("div");a.className=r?"attacker-crit-number":"attacker-damage-number",a.textContent=`${e}`,t.appendChild(a),setTimeout(()=>a.remove(),r?1500:1200)}showCombatText(t,e,r){const a=document.createElement("div");a.className=r,a.textContent=e,t.appendChild(a),setTimeout(()=>a.remove(),1200)}addCombatLog(t){this.combatLog.push(`Beat ${this.combatLog.length+1}: ${t}`),this.addChatMessage(`⚔️ ${t}`)}cleanupCombatElements(){const t=document.querySelector(".left-nameplate");t&&t.querySelectorAll(".fighter-health").forEach(t=>t.remove()),this.leftFighter.querySelectorAll(".damage-number, .block-text, .parry-text, .miss-text").forEach(t=>t.remove()),this.rightFighter.querySelectorAll(".damage-number, .block-text, .parry-text, .miss-text").forEach(t=>t.remove()),this.arenaViewport.querySelectorAll(".victor-text").forEach(t=>t.remove()),this.leftFighter.querySelectorAll(".victory-crown, .victory-nameplate").forEach(t=>t.remove()),this.rightFighter.querySelectorAll(".victory-crown, .victory-nameplate").forEach(t=>t.remove()),this.leftFighter.style.opacity="1",this.rightFighter.style.opacity="1",this.leftFighter.style.removeProperty("--start-position"),this.leftFighter.style.removeProperty("--start-transform"),this.rightFighter.style.removeProperty("--start-position"),this.rightFighter.style.removeProperty("--start-transform"),this.leftFighter.classList.remove("victory-center"),this.rightFighter.classList.remove("victory-center");const e=this.getMaxHPForRound();this.leftFighterHP=e,this.rightFighterHP=e,this.combatLog=[],this.currentTurn="left",this.combatRound=1}generateCharacterColors(t){let e=0;for(let s=0;s<t.length;s++)e=(e<<5)-e+t.charCodeAt(s)&4294967295;const r=()=>(e=16807*e%2147483647,(e-1)/2147483646),a=[{primary:"#8B0000",secondary:"#A0001A",name:"Crimson"},{primary:"#006400",secondary:"#228B22",name:"Forest"},{primary:"#4B0082",secondary:"#6A0DAD",name:"Royal"},{primary:"#FF8C00",secondary:"#FFA500",name:"Amber"},{primary:"#191970",secondary:"#483D8B",name:"Midnight"},{primary:"#8B008B",secondary:"#9932CC",name:"Violet"},{primary:"#2F4F4F",secondary:"#708090",name:"Steel"},{primary:"#800000",secondary:"#A52A2A",name:"Burgundy"}],i=[{primary:"#4169E1",secondary:"#2E4BC7",boss:"#FFD700",name:"Sapphire"},{primary:"#DC143C",secondary:"#B22222",boss:"#FFD700",name:"Scarlet"},{primary:"#228B22",secondary:"#006400",boss:"#FFD700",name:"Emerald"},{primary:"#FF6347",secondary:"#FF4500",boss:"#FFD700",name:"Flame"},{primary:"#9932CC",secondary:"#8A2BE2",boss:"#FFD700",name:"Amethyst"},{primary:"#CD853F",secondary:"#D2691E",boss:"#FFD700",name:"Bronze"},{primary:"#483D8B",secondary:"#2F4F4F",boss:"#FFD700",name:"Slate"},{primary:"#B8860B",secondary:"#DAA520",boss:"#FFD700",name:"Golden"}],o=Math.floor(r()*a.length),n=Math.floor(r()*i.length);return{cape:a[o],shield:i[n]}}updateKnightColors(t,e){const r=this.generateCharacterColors(t),a=this.generateCharacterColors(e);this.applyKnightColors(this.leftFighter,r,"left"),this.applyKnightColors(this.rightFighter,a,"right")}applyKnightColors(t,e,r){}darkenColor(t){const e=t.replace("#",""),r=Math.max(0,Math.floor(.8*parseInt(e.substr(0,2),16))),a=Math.max(0,Math.floor(.8*parseInt(e.substr(2,2),16))),i=Math.max(0,Math.floor(.8*parseInt(e.substr(4,2),16)));return`#${r.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`}renderBracket(){if(!this.bracketDisplay)return;const t=this.tournament.getRoundInfo(),e=this.tournament.getCurrentMatch(),r=['<div class="bracket-tree">'];for(let a=0;a<this.tournament.bracket.length-1;a++){const i=this.tournament.bracket[a],o=this.getRoundName(a+1),n=a+1===t.current;r.push('<div class="bracket-round">'),r.push(`<div class="bracket-round-title ${n?"active-round":""}">${o}</div>`),r.push('<div class="bracket-matches">');for(let s=0;s<i.length;s+=2){const o=i[s],n=i[s+1],l=Math.floor(s/2),h=this.tournament.bracket[a+1],d=h&&h[l],c=e&&a+1===t.current&&(o===e.participant1&&n===e.participant2||o===e.participant2&&n===e.participant1),g=this.isMatchOnFollowingPath(o,n,a+1);r.push(this.renderMatch(o,n,d,c,h?h[l]:null,g,a<this.tournament.bracket.length-2))}r.push("</div></div>")}if(this.tournament.isComplete()){const t=this.tournament.getWinner();r.push('<div class="bracket-round">'),r.push('<div class="bracket-round-title">CHAMPION</div>'),r.push(`<div class="bracket-winner-display">🏆 ${t} 🏆</div>`),r.push("</div>")}r.push("</div>"),this.bracketDisplay.innerHTML=r.join(""),this.updateSliderRange(),setTimeout(()=>{this.scrollToCurrentMatch()},100)}renderMatch(t,e,r,a,i,o,n){if(!t&&!e)return'<div class="bracket-match empty"><div class="bracket-bye">Empty</div></div>';if(!t||!e){const r=t||e;let a="bracket-match bye-match";return o&&(a+=" following-path"),`<div class="${a}">\n                <div class="bracket-participant bye-winner ${r===this.tournament.followingCharacter?"following":""}">${r}</div>\n                ${n?'<div class="bracket-connector'+(o?" active":"")+'"></div>':""}\n            </div>`}let s="bracket-match";r&&(s+=" completed"),a&&(s+=" current"),o&&(s+=" following-path");let l=`<div class="${s}">`,h="bracket-participant";r&&i===t?h+=" winner":r&&i!==t&&(h+=" eliminated"),t===this.tournament.followingCharacter&&(h+=" following"),l+=`<div class="${h}">${t}</div>`,l+='<div class="vs-separator">VS</div>';let d="bracket-participant";return r&&i===e?d+=" winner":r&&i!==e&&(d+=" eliminated"),e===this.tournament.followingCharacter&&(d+=" following"),l+=`<div class="${d}">${e}</div>`,n&&(l+=`<div class="bracket-connector${o?" active":""}"></div>`),l+="</div>",l}isMatchOnFollowingPath(t,e,r){return t===this.tournament.followingCharacter||e===this.tournament.followingCharacter||this.isCharacterInFuturePath(t,e,r)}isCharacterInFuturePath(t,e,r){let a=this.tournament.followingCharacter;for(let i=this.tournament.currentRound-1;i>=r;i--){const r=this.tournament.bracket[i-1],o=this.tournament.bracket[i];for(let i=0;i<r.length;i+=2){const n=r[i],s=r[i+1];if(o[Math.floor(i/2)]===a&&(n===t||n===e||s===t||s===e))return!0}}return!1}getRoundName(t){return{1:"Round of 128",2:"Round of 64",3:"Round of 32",4:"Round of 16",5:"Quarterfinals",6:"Semifinals",7:"Final"}[t]||`Round ${t}`}sendUserMessage(){if(!this.chatInput)return;const t=this.chatInput.value.trim();""!==t&&(this.addUserChatMessage(t),this.chatInput.value="")}addUserChatMessage(t){if(!this.chatMessages||!t)return;const e=document.createElement("div");e.className="chat-message user-message",e.innerHTML=`\n            <span class="chat-username user-username">You: ${t}</span>\n        `,this.chatMessages.appendChild(e),this.chatMessages.scrollTop=this.chatMessages.scrollHeight}initProgressBar(){if(!this.progressSegments)return;const t=this.tournament.getRoundInfo();this.progressSegments.innerHTML="";for(let e=0;e<t.total;e++){const t=document.createElement("div");t.className="progress-segment remaining",this.progressSegments.appendChild(t)}this.updateProgressBar()}updateProgressBar(){if(!this.progressSegments)return;const t=this.tournament.getRoundInfo(),e=this.progressSegments.children;console.log(`Tournament Progress: Round ${t.current} of ${t.total} (${t.name})`),console.log(`Participants left: ${t.participantsLeft}`);const r=["tier-gray","tier-white","tier-green","tier-blue","tier-purple","tier-orange","tier-gold"];for(let a=0;a<e.length;a++)if(a<t.current-1){const t=r[a]||"tier-gold";e[a].className=`progress-segment completed ${t}`}else a===t.current-1?e[a].className="progress-segment current":e[a].className="progress-segment remaining";this.updateLootGem(t)}updateLootGem(t){this.updateLootBox(t)}updateLootBox(t){const e=document.getElementById("loot-box");if(!e)return;const r=[{name:"unknown",material:"Unknown",chestNumber:8},{name:"wood",material:"Wooden",chestNumber:7},{name:"stone",material:"Stone",chestNumber:6},{name:"bronze",material:"Bronze",chestNumber:5},{name:"silver",material:"Silver",chestNumber:4},{name:"gold",material:"Golden",chestNumber:3},{name:"platinum",material:"Platinum",chestNumber:2},{name:"diamond",material:"Diamond",chestNumber:1}],a=Math.max(0,t.current-1),i=r[Math.min(a,r.length-1)],o=document.querySelector(".loot-header");o&&(o.textContent=`${i.material.toUpperCase()} LOOT`);const n=i.chestNumber.toString().padStart(2,"0"),s=`./images/Loot/chest_${n}.png`,l=e.querySelector(".loot-chest-image");l&&l.src.includes(`chest_${n}.png`)||(e.style.opacity="0",e.style.transition="opacity 0.3s ease-in-out",setTimeout(()=>{e.innerHTML=`<img src="${s}" alt="${i.material} Chest" class="loot-chest-image">`,e.style.opacity="1"},300))}createLootBoxSVG(t){const{colors:e}=t;return"unknown"===t.name?`<svg width="140" height="120" viewBox="0 0 120 100" class="loot-svg">\n                <rect x="25" y="50" width="70" height="35" fill="${e.base}" stroke="#303030" stroke-width="2" rx="3"/>\n                <path d="M25 50 Q25 35 60 35 Q95 35 95 50 L95 45 Q95 30 60 30 Q25 30 25 45 Z" fill="${e.lid}" stroke="${e.base}" stroke-width="2"/>\n                <text x="60" y="55" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="${e.accent}" text-anchor="middle">?</text>\n                <circle cx="30" cy="60" r="3" fill="#303030" stroke="#202020" stroke-width="1"/>\n                <circle cx="90" cy="60" r="3" fill="#303030" stroke="#202020" stroke-width="1"/>\n                <circle cx="30" cy="75" r="3" fill="#303030" stroke="#202020" stroke-width="1"/>\n                <circle cx="90" cy="75" r="3" fill="#303030" stroke="#202020" stroke-width="1"/>\n            </svg>`:`<svg width="140" height="120" viewBox="0 0 120 100" class="loot-svg">\n            <rect x="25" y="50" width="70" height="35" fill="${e.base}" stroke="${this.darkenColor(e.base)}" stroke-width="2" rx="3"/>\n            <path d="M25 50 Q25 35 60 35 Q95 35 95 50 L95 45 Q95 30 60 30 Q25 30 25 45 Z" fill="${e.lid}" stroke="${e.base}" stroke-width="2"/>\n            <rect x="57" y="42" width="6" height="8" fill="${e.accent}" stroke="${this.darkenColor(e.accent)}" stroke-width="1" rx="1"/>\n            <circle cx="60" cy="46" r="2" fill="${e.accent}" stroke="${this.darkenColor(e.accent)}" stroke-width="1"/>\n            <rect x="23" y="55" width="74" height="3" fill="${this.darkenColor(e.base)}"/>\n            <rect x="23" y="70" width="74" height="3" fill="${this.darkenColor(e.base)}"/>\n            <circle cx="30" cy="60" r="3" fill="${e.base}" stroke="${this.darkenColor(e.base)}" stroke-width="1"/>\n            <circle cx="90" cy="60" r="3" fill="${e.base}" stroke="${this.darkenColor(e.base)}" stroke-width="1"/>\n            <circle cx="30" cy="75" r="3" fill="${e.base}" stroke="${this.darkenColor(e.base)}" stroke-width="1"/>\n            <circle cx="90" cy="75" r="3" fill="${e.base}" stroke="${this.darkenColor(e.base)}" stroke-width="1"/>\n            ${"diamond"===t.name?'<polygon points="60,20 65,30 55,30" fill="#00CED1" stroke="#008B8B" stroke-width="1"/>':""}\n        </svg>`}initBracketControls(){this.bracketViewport&&this.bracketSlider&&this.zoomInBtn&&this.zoomOutBtn&&(this.zoomInBtn.addEventListener("click",()=>this.zoomIn()),this.zoomOutBtn.addEventListener("click",()=>this.zoomOut()),this.bracketSlider.addEventListener("input",t=>{this.updateVerticalScroll(t.target.value)}),this.bracketViewport.addEventListener("scroll",()=>{this.syncSliderWithScroll()}),this.bracketViewport.addEventListener("wheel",t=>{t.ctrlKey&&(t.preventDefault(),t.deltaY<0?this.zoomIn():this.zoomOut())}),this.updateSliderRange())}zoomIn(){this.currentZoom<3&&(this.currentZoom=Math.min(3,this.currentZoom+.2),this.updateBracketTransform(),this.updateZoomDisplay(),this.updateSliderRange())}zoomOut(){this.currentZoom>.5&&(this.currentZoom=Math.max(.5,this.currentZoom-.2),this.updateBracketTransform(),this.updateZoomDisplay(),this.updateSliderRange())}updateBracketTransform(){this.bracketDisplay&&(this.bracketDisplay.style.transform=`scale(${this.currentZoom})`)}updateZoomDisplay(){this.zoomLevel&&(this.zoomLevel.textContent=`${Math.round(100*this.currentZoom)}%`)}updateVerticalScroll(t){if(!this.bracketViewport)return;const e=this.bracketViewport.scrollHeight-this.bracketViewport.clientHeight;this.bracketViewport.scrollTop=e*(t/100)}syncSliderWithScroll(){if(!this.bracketSlider||!this.bracketViewport)return;const t=this.bracketViewport.scrollHeight-this.bracketViewport.clientHeight;if(t>0){const e=this.bracketViewport.scrollTop/t*100;this.bracketSlider.value=e}}updateSliderRange(){this.bracketSlider&&this.bracketViewport&&setTimeout(()=>{this.bracketViewport.scrollHeight-this.bracketViewport.clientHeight<=0?(this.bracketSlider.style.opacity="0.3",this.bracketSlider.disabled=!0):(this.bracketSlider.style.opacity="1",this.bracketSlider.disabled=!1)},100)}initBracketAutoScroll(){setInterval(()=>{if(this.tournamentStarted&&!this.tournament.isComplete()){const t=this.bracketDisplay?.querySelector(".bracket-match.current");if(t){const e=this.bracketViewport?.getBoundingClientRect(),r=t.getBoundingClientRect();e&&r&&(r.top>=e.top&&r.bottom<=e.bottom||(console.log("Current match not visible, auto-scrolling..."),this.scrollToCurrentMatch()))}}},3e3)}initBracketAccordion(){const t=document.getElementById("bracket-toggle"),e=document.getElementById("bracket-content");t&&e&&(e.classList.remove("expanded"),t.classList.remove("expanded"),t.addEventListener("click",r=>{r.target.closest(".bracket-zoom-controls")||(e.classList.contains("expanded")?(e.classList.remove("expanded"),t.classList.remove("expanded")):(e.classList.add("expanded"),t.classList.add("expanded")))}))}scrollToCurrentMatch(){if(!this.bracketViewport||!this.bracketDisplay)return void console.log("Bracket viewport or display not found");const t=this.bracketDisplay.querySelector(".bracket-match.current");if(!t){console.log("No current match element found");const t=this.bracketDisplay.querySelector(".bracket-round");if(t){const e=t.offsetTop-this.bracketViewport.clientHeight/4;this.bracketViewport.scrollTo({top:Math.max(0,e),behavior:"smooth"})}return}console.log("Found current match element, scrolling to it");const e=t.closest(".bracket-round");e?setTimeout(()=>{const t=e.offsetTop,r=this.bracketViewport.clientHeight,a=Math.max(0,t-r/3);console.log("Scrolling to round at position:",a),this.bracketViewport.scrollTo({top:a,behavior:"smooth"}),setTimeout(()=>{this.syncSliderWithScroll&&this.syncSliderWithScroll()},600)},50):console.log("No current round found")}initBracketOverlay(){const t=document.getElementById("bracket-mode");document.getElementById("bracket-overlay");const e=document.getElementById("close-bracket"),r=document.querySelector(".bracket-overlay-background");t&&t.addEventListener("click",()=>{this.showBracketOverlay()}),e&&e.addEventListener("click",()=>{this.hideBracketOverlay()}),r&&r.addEventListener("click",()=>{this.hideBracketOverlay()})}showBracketOverlay(){const t=document.getElementById("bracket-overlay"),e=document.getElementById("overlay-bracket-display");t&&(t.classList.remove("hidden"),e&&this.bracketDisplay&&(e.innerHTML=this.bracketDisplay.innerHTML))}hideBracketOverlay(){const t=document.getElementById("bracket-overlay");t&&t.classList.add("hidden")}}document.addEventListener("DOMContentLoaded",()=>{new r}),document.addEventListener("DOMContentLoaded",()=>{new r})}}});
