<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>RNG: Legends</title>
    <meta name="description" content="Epic medieval tournament battles with turn-based combat and RNG mechanics">
    <meta name="theme-color" content="#1a1a2e">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="manifest" href="/manifest.json">
    <link rel="preload" href="styles.css" as="style">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="dev-frame">
        <!-- Loading Screen -->
        <div id="loading-screen" class="game-screen">
            <div class="loading-container">
                <!-- Loading Music -->
                <audio id="home-music" loop>
                    <source src="/sfx/RNG Home.mp3" type="audio/mpeg">
                </audio>

                <!-- Parallax Background Layers -->
                <div class="parallax-clouds" data-speed="0.225"></div>
                <div class="parallax-logo" data-speed="0.3"></div>
                <div class="parallax-castle" data-speed="0.6"></div>
                <div class="parallax-trees" data-speed="0.9"></div>

                <!-- Characters at Bottom -->
                <div class="home-characters">
                    <img src="/images/Home Screen/Aphrodite.png" alt="Aphrodite" class="home-character home-aphrodite" data-speed="0.75">
                    <img src="/images/Home Screen/hero.png" alt="Hero" class="home-character home-hero" data-speed="1.05">
                    <img src="/images/Home Screen/black knight.png" alt="Black Knight" class="home-character home-black-knight" data-speed="0.75">
                </div>

                <!-- Loading Bar -->
                <div class="loading-bar-container">
                    <div class="loading-bar-fill" id="loading-bar-fill"></div>
                </div>

                <!-- Start Button (hidden initially) -->
                <button id="start-btn" class="start-btn hidden">START</button>

                <!-- Mute Button -->
                <button id="mute-btn" class="loading-mute-btn" aria-label="Toggle audio mute">
                    <img src="/images/UX Images/sound-off.png" alt="Muted" class="icon-img">
                </button>
            </div>
        </div>

        <!-- Home Screen -->
        <div id="home-screen" class="game-screen hidden">
            <div class="home-container">
                <!-- Town Background -->
                <div class="town-background"></div>

                <!-- Countdown Timer (Top Center) -->
                <div class="home-countdown-timer" id="home-countdown-timer">
                    <div class="countdown-label">Daily Tournament starts in</div>
                    <div class="countdown-time">02:31:40</div>
                </div>

                <!-- Events Button (Top Left) -->
                <button id="home-events-btn" class="home-dominion-btn" aria-label="Open Events">
                    <img src="/images/Home Screen/events_icon.png" alt="Events">
                </button>

                <!-- Castle Button (Top Right) -->
                <button id="home-castle-btn" class="home-castle-menu-btn" aria-label="Open Castle menu">
                    <img src="/images/Home Screen/castle-icon.png" alt="Castle">
                </button>

                <!-- PVP Button (Top Right, below countdown) -->
                <button id="home-pvp-btn" class="home-pvp-btn" aria-label="Start PVP tournament">
                    <img src="/images/Home Screen/PVP.png" alt="PVP Mode">
                </button>

                <!-- PVE Button (Top Left, below currency) -->
                <button id="home-pve-btn" class="home-corner-btn home-pve-btn" aria-label="Open PVE battle map">
                    <img src="/images/Home Screen/PVE.png" alt="PVE Tournament">
                </button>

                <!-- Store Button (Center) -->
                <button id="home-store-btn" class="home-corner-btn home-store-btn" aria-label="Open store">
                    <img src="/images/Home Screen/store.png" alt="Store">
                </button>

                <!-- Bottom Navigation Bar -->
                <div class="home-bottom-bar">
                    <button id="home-events-btn-bar" class="home-bar-btn">
                        <img src="/images/Home Screen/events_icon.png" alt="Events">
                        <span class="home-bar-label">EVENTS</span>
                    </button>
                    <button id="home-social-btn-bar" class="home-bar-btn">
                        <img src="/images/Home Screen/Guilds.png" alt="Social">
                        <span class="home-bar-label">SOCIAL</span>
                    </button>
                    <button id="home-pve-btn-bar" class="home-bar-btn">
                        <img src="/images/Home Screen/PVE.png" alt="PVE">
                        <span class="home-bar-label">PVE</span>
                    </button>
                    <button id="home-pvp-btn-bar" class="home-bar-btn">
                        <img src="/images/Home Screen/PVP.png" alt="Tournament">
                        <span class="home-bar-label">TOURNAMENT</span>
                    </button>
                    <button id="home-store-btn-bar" class="home-bar-btn">
                        <img src="/images/Home Screen/store.png" alt="Store">
                        <span class="home-bar-label">STORE</span>
                    </button>
                    <button id="home-castle-btn-bar" class="home-bar-btn">
                        <img src="/images/Home Screen/castle-icon.png" alt="Castle">
                        <span class="home-bar-label">CASTLE</span>
                    </button>
                </div>

                <!-- Top Left Controls - Settings and Audio -->
                <div class="home-top-left-controls">
                    <button id="home-settings-btn" class="home-small-btn" aria-label="Open settings">
                        <img src="/images/UX Images/settings.png" alt="Settings" class="icon-img">
                    </button>
                    <button id="home-audio-btn" class="home-small-btn" aria-label="Toggle audio">
                        <img src="/images/UX Images/Sound.png" alt="Sound" class="icon-img">
                    </button>
                </div>

                <!-- Top Right Controls - Currency -->
                <div class="home-top-right-controls">
                    <div class="home-currency" id="home-currency-display">
                        <div class="home-currency-item">
                            <img src="/images/effects/Gold Coin.webp" alt="Gold" class="home-currency-icon" loading="lazy">
                            <span id="home-gold-display-top" class="home-currency-value">10,000</span>
                        </div>
                        <div class="home-currency-item">
                            <span class="home-currency-icon-gem">üíé</span>
                            <span id="home-gems-display" class="home-currency-value">120</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Battle Pass Overlay -->
        <div id="battlepass-overlay" class="battlepass-overlay hidden">
            <div class="battlepass-background"></div>
            <button id="battlepass-close-btn" class="battlepass-close-btn" aria-label="Close Battle Pass">‚úï</button>
            <img src="/images/Home Screen/battle-pass.png" alt="Battle Pass" class="battlepass-image" loading="lazy">
        </div>

        <!-- Store Screen -->
        <div id="store-screen" class="game-screen hidden">
            <div class="store-container">
                <!-- Main Store Display -->
                <div class="store-display">
                    <img id="store-main-image" src="/images/shop/shop.png" alt="Store" class="store-image" data-speed="0.8" loading="lazy">
                </div>

                <!-- Battle Pass Button -->
                <button id="store-battlepass-btn" class="store-battlepass-btn" aria-label="View Battle Pass">
                    <img src="/images/Home Screen/Pass.png" alt="Battle Pass" loading="lazy">
                </button>

                <!-- Store Icon Button (Bottom Right) -->
                <button id="store-purchase-btn" class="store-purchase-btn" aria-label="View Purchase Options">
                    <img src="/images/shop/shop_icon.png" alt="Purchase Gold & Gems" loading="lazy">
                </button>

                <!-- Back Button -->
                <button id="store-back-btn" class="store-back-btn" aria-label="Return to home">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- Social Screen -->
        <div id="social-screen" class="game-screen hidden">
            <div class="social-container">
                <!-- Parallax Background Layers -->
                <div class="social-bg-layer social-bg-back"></div>
                <div class="social-bg-layer social-bg-front"></div>

                <!-- Social Feature Buttons -->
                <div class="social-features">
                    <h1 class="social-title">SOCIAL HUB</h1>

                    <div class="social-buttons-grid">
                        <button class="social-feature-btn" id="guilds-btn">
                            <div class="feature-icon">üè∞</div>
                            <div class="feature-name">Guilds</div>
                            <div class="feature-lock">üîí</div>
                        </button>

                        <button class="social-feature-btn" id="friends-btn">
                            <div class="feature-icon">üë•</div>
                            <div class="feature-name">Friends</div>
                            <div class="feature-lock">üîí</div>
                        </button>

                        <button class="social-feature-btn" id="chat-btn">
                            <div class="feature-icon">üí¨</div>
                            <div class="feature-name">Chat</div>
                            <div class="feature-lock">üîí</div>
                        </button>

                        <button class="social-feature-btn" id="leaderboards-btn">
                            <div class="feature-icon">üèÜ</div>
                            <div class="feature-name">Leaderboards</div>
                            <div class="feature-lock">üîí</div>
                        </button>

                        <button class="social-feature-btn" id="news-btn">
                            <div class="feature-icon">üì∞</div>
                            <div class="feature-name">News</div>
                            <div class="feature-lock">üîí</div>
                        </button>

                        <button class="social-feature-btn" id="dominion-btn">
                            <div class="feature-icon">üó∫Ô∏è</div>
                            <div class="feature-name">Dominion</div>
                        </button>
                    </div>
                </div>

                <!-- Back Button -->
                <button id="social-back-btn" class="castle-back-btn" aria-label="Return to home">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>

                <!-- Coming Soon Modal -->
                <div id="coming-soon-modal" class="coming-soon-modal hidden">
                    <div class="coming-soon-modal-overlay"></div>
                    <div class="coming-soon-modal-content">
                        <button class="coming-soon-close" id="coming-soon-close">√ó</button>
                        <h2 class="coming-soon-modal-title" id="modal-title">Feature Name</h2>
                        <p class="coming-soon-modal-desc" id="modal-description">Feature description goes here.</p>
                        <ul class="coming-soon-modal-features" id="modal-features">
                            <!-- Features populated by JavaScript -->
                        </ul>
                        <div class="coming-soon-badge-large">COMING SOON</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Purchase Screen -->
        <div id="purchase-screen" class="game-screen hidden">
            <div class="purchase-container">
                <!-- Purchase Background Image -->
                <div class="purchase-display">
                    <img id="purchase-main-image" src="/images/shop/purchase.png" alt="Purchase Screen" class="purchase-image" data-speed="0.5" loading="lazy">
                </div>

                <!-- Purchase Options -->
                <div class="purchase-options">
                    <!-- Gold Section -->
                    <div class="purchase-section">
                        <h2 class="purchase-section-title">
                            <img src="/images/effects/Gold Coin.webp" alt="Gold" class="purchase-currency-icon">
                            GOLD PACKS
                        </h2>
                        <div class="purchase-grid">
                            <button class="purchase-btn" data-type="gold" data-price="2.00">
                                <div class="purchase-amount">1,000</div>
                                <div class="purchase-price">$2.00</div>
                            </button>
                            <button class="purchase-btn" data-type="gold" data-price="5.00">
                                <div class="purchase-amount">3,000</div>
                                <div class="purchase-price">$5.00</div>
                            </button>
                            <button class="purchase-btn" data-type="gold" data-price="10.00">
                                <div class="purchase-amount">7,000</div>
                                <div class="purchase-price">$10.00</div>
                            </button>
                            <button class="purchase-btn" data-type="gold" data-price="20.00">
                                <div class="purchase-amount">15,000</div>
                                <div class="purchase-price">$20.00</div>
                            </button>
                            <button class="purchase-btn" data-type="gold" data-price="50.00">
                                <div class="purchase-amount">40,000</div>
                                <div class="purchase-price">$50.00</div>
                            </button>
                            <button class="purchase-btn" data-type="gold" data-price="100.00">
                                <div class="purchase-amount">100,000</div>
                                <div class="purchase-price">$100.00</div>
                            </button>
                        </div>
                    </div>

                    <!-- Gems Section -->
                    <div class="purchase-section">
                        <h2 class="purchase-section-title">
                            <span class="purchase-currency-icon">üíé</span>
                            GEM PACKS
                        </h2>
                        <div class="purchase-grid">
                            <button class="purchase-btn purchase-btn-gem" data-type="gem" data-price="2.00">
                                <div class="purchase-amount">50</div>
                                <div class="purchase-price">$2.00</div>
                            </button>
                            <button class="purchase-btn purchase-btn-gem" data-type="gem" data-price="5.00">
                                <div class="purchase-amount">150</div>
                                <div class="purchase-price">$5.00</div>
                            </button>
                            <button class="purchase-btn purchase-btn-gem" data-type="gem" data-price="10.00">
                                <div class="purchase-amount">350</div>
                                <div class="purchase-price">$10.00</div>
                            </button>
                            <button class="purchase-btn purchase-btn-gem" data-type="gem" data-price="20.00">
                                <div class="purchase-amount">750</div>
                                <div class="purchase-price">$20.00</div>
                            </button>
                            <button class="purchase-btn purchase-btn-gem" data-type="gem" data-price="50.00">
                                <div class="purchase-amount">2,000</div>
                                <div class="purchase-price">$50.00</div>
                            </button>
                            <button class="purchase-btn purchase-btn-gem" data-type="gem" data-price="100.00">
                                <div class="purchase-amount">5,000</div>
                                <div class="purchase-price">$100.00</div>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Back Button -->
                <button id="purchase-back-btn" class="castle-back-btn" aria-label="Return to home">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- Castle Screen -->
        <div id="castle-screen" class="game-screen hidden">
            <div class="castle-container">
                <!-- Parallax Background Layers -->
                <div class="castle-parallax-clouds" data-speed="0.45"></div>
                <div class="castle-parallax-castle" data-speed="0.6" id="castle-parallax-1"></div>
                <div class="castle-parallax-castle-complete hidden" data-speed="0.6" id="castle-parallax-2"></div>
                <div class="castle-parallax-tree" data-speed="0.75"></div>
                <div class="castle-parallax-rock" data-speed="0.9"></div>

                <!-- Clickable overlay for castle -->
                <div class="castle-clickable-overlay" id="castle-click-overlay"></div>

                <!-- Castle Tabs Container (Bottom Center) -->
                <div class="castle-tabs-container">
                    <div id="castle-level-tab" class="castle-tab castle-level-tab" aria-label="Castle Level">
                        LVL 1
                    </div>
                    <button id="castle-enter-btn" class="castle-tab castle-enter-tab" aria-label="Enter Castle">
                        ENTER
                    </button>
                    <button id="castle-pve-btn" class="castle-tab castle-pve-tab" aria-label="Go to PVE Map">
                        PVE
                    </button>
                </div>

                <!-- Back Button -->
                <button id="castle-back-btn" class="back-btn" aria-label="Return to home">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="back-btn-icon">
                </button>

                <!-- Castle Level Info Popup -->
                <div id="castle-level-popup" class="info-popup hidden">
                    <div class="info-popup-overlay"></div>
                    <div class="info-popup-content">
                        <h2 class="info-popup-title">CASTLE LEVELING</h2>
                        <div class="info-popup-text">
                            <p>Your castle level increases as you complete PVE areas and collect all trophies.</p>
                            <p><strong>How it works:</strong></p>
                            <ul>
                                <li>Complete all battles in a PVE area</li>
                                <li>Collect all trophies from that area</li>
                                <li>Your castle levels up when an area is fully completed</li>
                            </ul>
                            <p>Finish the first PVE map (ending with the Dragon) to reach <strong>Level 2</strong>!</p>
                        </div>
                        <button class="info-popup-close">CLOSE</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Castle Interior Screen -->
        <div id="castle-interior-screen" class="game-screen hidden">
            <div class="castle-interior-container">
                <!-- Castle Interior Background -->
                <div class="castle-interior-background" data-speed="0.5"></div>

                <!-- Bottom Bar with Room Icons -->
                <div class="castle-bottom-bar">
                    <button id="gear-room-btn" class="castle-bar-btn" aria-label="Enter Gear Room">
                        <img src="/images/Castle/Armoury_Icon.png" alt="Armory">
                        <span class="castle-bar-label">ARMORY</span>
                    </button>
                    <button id="awards-titles-btn" class="castle-bar-btn" aria-label="Enter Awards & Titles">
                        <img src="/images/Castle/Awards_Icon.png" alt="Awards">
                        <span class="castle-bar-label">AWARDS</span>
                    </button>
                    <button id="trophy-room-btn" class="castle-bar-btn" aria-label="Enter Trophy Room">
                        <img src="/images/Castle/Trophy_room_icon.png" alt="Trophy">
                        <span class="castle-bar-label">TROPHY</span>
                    </button>
                </div>

                <!-- Back Button -->
                <button id="castle-interior-back-btn" class="castle-back-btn" aria-label="Return to castle entrance">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- Gear Room Screen -->
        <div id="gear-room-screen" class="game-screen hidden">
            <div class="gear-room-container">
                <!-- Castle Gear Room Background -->
                <div class="gear-room-background"></div>

                <!-- Clickable overlays for navigation -->
                <div class="gear-room-clickable-left" id="gear-room-pvp-click"></div>
                <div class="gear-room-clickable-right" id="gear-room-pve-click"></div>

                <!-- Mannequin 2 (Left - PVP) -->
                <div class="mannequin-display mannequin-left clickable-mannequin" id="pvp-mannequin">
                    <img src="/images/Castle/PVP_mannequin.png" alt="PVP Mannequin" class="mannequin-image">
                </div>

                <!-- Mannequin 1 (Right - PVE) -->
                <div class="mannequin-display mannequin-right clickable-mannequin" id="pve-mannequin">
                    <img src="/images/Castle/PVE_mannequin.png" alt="PVE Mannequin" class="mannequin-image">
                </div>

                <!-- PVP Info Window (Left) -->
                <div class="mannequin-info-window mannequin-info-left" id="pvp-mannequin-btn">
                    <div class="mannequin-info-title">PVP</div>
                    <div class="mannequin-info-text">
                        Your PVP loadout for tournament battles. Customize your gear to dominate the arena
                        and climb the ranks. Every piece of equipment can mean the difference between glory
                        and defeat in the brutal world of competitive combat.
                    </div>
                </div>

                <!-- PVE Info Window (Right) -->
                <div class="mannequin-info-window mannequin-info-right" id="pve-mannequin-btn">
                    <div class="mannequin-info-title">PVE</div>
                    <div class="mannequin-info-text">
                        Your PVE loadout for monster hunting. Equip powerful gear to conquer increasingly
                        dangerous foes and collect legendary loot. Adapt your equipment to counter each
                        monster's unique abilities and special attacks.
                    </div>
                </div>

                <!-- Back Button -->
                <button id="gear-room-back-btn" class="castle-back-btn" aria-label="Return to castle interior">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- PVP Gear Library Screen -->
        <div id="pvp-gear-library-screen" class="game-screen hidden">
            <div class="gear-library-container">
                <!-- Blurred Background -->
                <div class="gear-library-background gear-library-bg-blur"></div>

                <!-- Mannequin Display (Left) -->
                <div class="gear-library-mannequin mannequin-library-left" id="pvp-mannequin-container" data-library="pvp">
                    <img src="/images/Castle/PVP_mannequin.png" alt="PVP Mannequin" class="mannequin-base">

                    <!-- Gear Slots Overlay -->
                    <div class="gear-slots-overlay hidden" id="pvp-gear-slots">
                        <!-- Mannequin Background (for slot view) -->
                        <div class="gear-slots-mannequin-bg">
                            <img src="/images/Castle/PVP_mannequin.png" alt="PVP Mannequin">
                        </div>

                        <!-- Gear Slot Grid -->
                        <div class="gear-slots-grid">
                            <!-- Row 1: Ring1, Helmet, Ring2 -->
                            <div class="gear-slot" data-slot="ring1" data-row="1">
                                <div class="gear-slot-label">Ring 1</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="helmet" data-row="1">
                                <div class="gear-slot-label">Helmet</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="ring2" data-row="1">
                                <div class="gear-slot-label">Ring 2</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="1"></div>

                            <!-- Row 2: Back, Chest, Gauntlets -->
                            <div class="gear-slot" data-slot="back" data-row="2">
                                <div class="gear-slot-label">Back</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="chest" data-row="2">
                                <div class="gear-slot-label">Chest</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="gauntlets" data-row="2">
                                <div class="gear-slot-label">Gauntlets</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="2"></div>

                            <!-- Row 3: Weapon, Pants, Offhand -->
                            <div class="gear-slot" data-slot="weapon" data-row="3">
                                <div class="gear-slot-label">Weapon</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="pants" data-row="3">
                                <div class="gear-slot-label">Pants</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="offhand" data-row="3">
                                <div class="gear-slot-label">Off-hand</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="3"></div>

                            <!-- Row 4: Boots, Trinket -->
                            <div class="gear-slot gear-slot-empty" data-row="4"></div>
                            <div class="gear-slot" data-slot="boots" data-row="4">
                                <div class="gear-slot-label">Boots</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="trinket" data-row="4">
                                <div class="gear-slot-label">Trinket</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="4"></div>
                        </div>

                        <!-- Stats Display Panel - Full overlay -->
                        <div class="gear-stats-panel" id="pvp-stats-panel">
                            <div class="gear-stats-title">TOTAL STATS</div>
                            <div class="gear-stats-list">
                                <div class="gear-stat"><span class="stat-name">Attack</span> <span class="stat-value" data-stat="attack">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Defense</span> <span class="stat-value" data-stat="defense">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Health</span> <span class="stat-value" data-stat="health">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Crit</span> <span class="stat-value" data-stat="crit">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Dodge</span> <span class="stat-value" data-stat="dodge">0</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Control Buttons - Outside mannequin for corner positioning -->
                <div class="gear-controls" id="pvp-gear-controls">
                    <button class="gear-equip-set-btn hidden" id="pvp-equip-set-btn" title="Equip Full Set">
                        EQUIP SET
                    </button>
                    <div class="gear-controls-row">
                        <button class="gear-stats-toggle" id="pvp-stats-toggle" title="Toggle Stats">
                            üìä
                        </button>
                        <button class="gear-view-toggle" id="pvp-view-toggle" title="Toggle View">
                            ‚áÑ
                        </button>
                    </div>
                </div>

                <!-- Gear Grid (Right) -->
                <div class="gear-library-grid gear-grid-right">
                    <div class="gear-grid-header">PVP GEAR LIBRARY</div>
                    <div class="gear-grid-scroll" id="pvp-gear-scroll">
                        <!-- Gear items populated by JavaScript -->
                    </div>
                </div>

                <!-- Switch Library Button -->
                <button id="pvp-switch-library-btn" class="switch-library-btn" aria-label="Switch to PVE library">
                    PVE
                </button>

                <!-- Back Button -->
                <button id="pvp-library-back-btn" class="castle-back-btn" aria-label="Return to gear room">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- PVE Gear Library Screen -->
        <div id="pve-gear-library-screen" class="game-screen hidden">
            <div class="gear-library-container">
                <!-- Blurred Background -->
                <div class="gear-library-background gear-library-bg-blur"></div>

                <!-- Mannequin Display (Right) -->
                <div class="gear-library-mannequin mannequin-library-right" id="pve-mannequin-container" data-library="pve">
                    <img src="/images/Castle/PVE_mannequin.png" alt="PVE Mannequin" class="mannequin-base">

                    <!-- Gear Slots Overlay -->
                    <div class="gear-slots-overlay hidden" id="pve-gear-slots">
                        <!-- Mannequin Background (for slot view) -->
                        <div class="gear-slots-mannequin-bg">
                            <img src="/images/Castle/PVE_mannequin.png" alt="PVE Mannequin">
                        </div>

                        <!-- Gear Slot Grid -->
                        <div class="gear-slots-grid">
                            <!-- Row 1: Ring1, Helmet, Ring2 -->
                            <div class="gear-slot" data-slot="ring1" data-row="1">
                                <div class="gear-slot-label">Ring 1</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="helmet" data-row="1">
                                <div class="gear-slot-label">Helmet</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="ring2" data-row="1">
                                <div class="gear-slot-label">Ring 2</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="1"></div>

                            <!-- Row 2: Back, Chest, Gauntlets -->
                            <div class="gear-slot" data-slot="back" data-row="2">
                                <div class="gear-slot-label">Back</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="chest" data-row="2">
                                <div class="gear-slot-label">Chest</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="gauntlets" data-row="2">
                                <div class="gear-slot-label">Gauntlets</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="2"></div>

                            <!-- Row 3: Weapon, Pants, Offhand -->
                            <div class="gear-slot" data-slot="weapon" data-row="3">
                                <div class="gear-slot-label">Weapon</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="pants" data-row="3">
                                <div class="gear-slot-label">Pants</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="offhand" data-row="3">
                                <div class="gear-slot-label">Off-hand</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="3"></div>

                            <!-- Row 4: Boots, Trinket -->
                            <div class="gear-slot gear-slot-empty" data-row="4"></div>
                            <div class="gear-slot" data-slot="boots" data-row="4">
                                <div class="gear-slot-label">Boots</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot" data-slot="trinket" data-row="4">
                                <div class="gear-slot-label">Trinket</div>
                                <div class="gear-slot-content"></div>
                            </div>
                            <div class="gear-slot gear-slot-empty" data-row="4"></div>
                        </div>

                        <!-- Stats Display Panel - Full overlay -->
                        <div class="gear-stats-panel" id="pve-stats-panel">
                            <div class="gear-stats-title">TOTAL STATS</div>
                            <div class="gear-stats-list">
                                <div class="gear-stat"><span class="stat-name">Attack</span> <span class="stat-value" data-stat="attack">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Defense</span> <span class="stat-value" data-stat="defense">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Health</span> <span class="stat-value" data-stat="health">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Crit</span> <span class="stat-value" data-stat="crit">0</span></div>
                                <div class="gear-stat"><span class="stat-name">Dodge</span> <span class="stat-value" data-stat="dodge">0</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Control Buttons - Outside mannequin for corner positioning -->
                <div class="gear-controls" id="pve-gear-controls">
                    <button class="gear-equip-set-btn hidden" id="pve-equip-set-btn" title="Equip Full Set">
                        EQUIP SET
                    </button>
                    <div class="gear-controls-row">
                        <button class="gear-stats-toggle" id="pve-stats-toggle" title="Toggle Stats">
                            üìä
                        </button>
                        <button class="gear-view-toggle" id="pve-view-toggle" title="Toggle View">
                            ‚áÑ
                        </button>
                    </div>
                </div>

                <!-- Gear Grid (Left) -->
                <div class="gear-library-grid gear-grid-left">
                    <div class="gear-grid-header">PVE GEAR LIBRARY</div>
                    <div class="gear-grid-scroll" id="pve-gear-scroll">
                        <!-- Gear items populated by JavaScript -->
                    </div>
                </div>

                <!-- Switch Library Button -->
                <button id="pve-switch-library-btn" class="switch-library-btn" aria-label="Switch to PVP library">
                    PVP
                </button>

                <!-- Back Button -->
                <button id="pve-library-back-btn" class="castle-back-btn" aria-label="Return to gear room">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- Awards & Titles Screen -->
        <div id="awards-titles-screen" class="game-screen hidden">
            <div class="awards-titles-container">
                <!-- Blurred Background -->
                <div class="awards-titles-background"></div>

                <!-- Main Tabbed Window -->
                <div class="awards-main-window">
                    <!-- Tab Headers -->
                    <div class="awards-tabs">
                        <button class="awards-tab" data-tab="titles">TITLES</button>
                        <button class="awards-tab" data-tab="awards">AWARDS</button>
                    </div>

                    <!-- Tab Content -->
                    <div class="awards-tab-content">
                        <!-- Titles Tab -->
                        <div class="tab-panel active" id="titles-panel">
                            <div class="awards-scroll-content" id="titles-scroll">
                                <div class="title-item" draggable="true" data-title="The Mediocre">
                                    <div class="title-name">The Mediocre</div>
                                </div>
                                <div class="title-item" draggable="true" data-title="Barely Competent">
                                    <div class="title-name">Barely Competent</div>
                                </div>
                                <div class="title-item" draggable="true" data-title="RNG Victim">
                                    <div class="title-name">RNG Victim</div>
                                </div>
                                <div class="title-item" draggable="true" data-title="Lucky Loser">
                                    <div class="title-name">Lucky Loser</div>
                                </div>
                                <div class="title-item" draggable="true" data-title="The Unfortunate">
                                    <div class="title-name">The Unfortunate</div>
                                </div>
                                <div class="title-item" draggable="true" data-title="Dice Roller">
                                    <div class="title-name">Dice Roller</div>
                                </div>
                            </div>
                        </div>

                        <!-- Awards Tab -->
                        <div class="tab-panel" id="awards-panel">
                            <div class="awards-scroll-content" id="awards-scroll">
                                <div class="award-item" draggable="true" data-award="participation">
                                    <div class="award-icon">üèÜ</div>
                                    <div class="award-text">
                                        <div class="award-name">Participation Trophy</div>
                                        <div class="award-desc">You showed up. That's... something.</div>
                                    </div>
                                </div>
                                <div class="award-item" draggable="true" data-award="accident">
                                    <div class="award-icon">‚öîÔ∏è</div>
                                    <div class="award-text">
                                        <div class="award-name">Accidentally Won</div>
                                        <div class="award-desc">Defeated an opponent by sheer luck.</div>
                                    </div>
                                </div>
                                <div class="award-item" draggable="true" data-award="punching-bag">
                                    <div class="award-icon">üõ°Ô∏è</div>
                                    <div class="award-text">
                                        <div class="award-name">Professional Punching Bag</div>
                                        <div class="award-desc">Lost 10 battles in a row. Impressive dedication!</div>
                                    </div>
                                </div>
                                <div class="award-item" draggable="true" data-award="near-death">
                                    <div class="award-icon">üíÄ</div>
                                    <div class="award-text">
                                        <div class="award-name">Near Death Experience</div>
                                        <div class="award-desc">Won a battle with 1 HP remaining.</div>
                                    </div>
                                </div>
                                <div class="award-item" draggable="true" data-award="miss">
                                    <div class="award-icon">üéØ</div>
                                    <div class="award-text">
                                        <div class="award-name">Couldn't Hit Water</div>
                                        <div class="award-desc">Missed 5 attacks in one battle if you fell in the ocean.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bottom Info Window -->
                    <div class="awards-bottom-info">
                        <div class="info-text" id="awards-info-text">Select a title or award to see more information. Drag and drop items to equip them.</div>
                    </div>
                </div>

                <!-- Equippable Slots Window -->
                <div class="equipped-slots-window">
                    <div class="equipped-header active" id="equipped-titles-header">EQUIPPED TITLES</div>
                    <div class="equipped-header" id="equipped-awards-header">EQUIPPED AWARDS</div>

                    <!-- Title Slots -->
                    <div class="equipped-content active" id="title-slots">
                        <div class="equipped-slot" data-slot="1" data-type="title">
                            <div class="slot-placeholder">Empty Slot</div>
                        </div>
                        <div class="equipped-slot" data-slot="2" data-type="title">
                            <div class="slot-placeholder">Empty Slot</div>
                        </div>
                        <div class="equipped-slot" data-slot="3" data-type="title">
                            <div class="slot-placeholder">Empty Slot</div>
                        </div>
                    </div>

                    <!-- Award Slots -->
                    <div class="equipped-content" id="award-slots">
                        <div class="equipped-slot" data-slot="1" data-type="award">
                            <div class="slot-placeholder">Empty Slot</div>
                        </div>
                        <div class="equipped-slot" data-slot="2" data-type="award">
                            <div class="slot-placeholder">Empty Slot</div>
                        </div>
                        <div class="equipped-slot" data-slot="3" data-type="award">
                            <div class="slot-placeholder">Empty Slot</div>
                        </div>
                    </div>
                </div>

                <!-- Info Popup Window -->
                <div id="item-info-popup" class="item-info-popup hidden">
                    <div class="item-info-popup-content">
                        <div class="item-info-header">
                            <span id="item-info-title"></span>
                            <button id="item-info-close" class="info-close-btn">√ó</button>
                        </div>
                        <div class="item-info-content">
                            <div id="item-info-icon" class="item-info-icon"></div>
                            <div id="item-info-description" class="item-info-description"></div>
                        </div>
                        <button id="item-info-equip-btn" class="item-info-equip-btn">EQUIP</button>
                    </div>
                </div>

                <!-- Back Button -->
                <button id="awards-titles-back-btn" class="castle-back-btn" aria-label="Return to castle interior">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- Trophy Room Screen -->
        <div id="trophy-room-screen" class="game-screen hidden">
            <div class="trophy-room-container">
                <!-- Trophy Room Background -->
                <div class="trophy-room-background"></div>

                <!-- Back Button -->
                <button id="trophy-room-back-btn" class="castle-back-btn" aria-label="Return to castle interior">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- Dominion Screen -->
        <div id="dominion-screen" class="game-screen hidden">
            <div class="dominion-container">
                <!-- Dominion Map Background -->
                <div class="dominion-map" id="dominion-map"></div>

                <!-- Map Navigation Buttons (Tab Style) -->
                <button class="dominion-nav-tab dominion-nav-up" id="dominion-nav-up" aria-label="Pan map up">‚ñ≤</button>
                <button class="dominion-nav-tab dominion-nav-down" id="dominion-nav-down" aria-label="Pan map down">‚ñº</button>
                <button class="dominion-nav-tab dominion-nav-left" id="dominion-nav-left" aria-label="Pan map left">‚óÑ</button>
                <button class="dominion-nav-tab dominion-nav-right" id="dominion-nav-right" aria-label="Pan map right">‚ñ∫</button>

                <!-- Zoom Controls (Bottom Left) -->
                <div class="dominion-zoom-controls">
                    <button class="dominion-zoom-btn" id="dominion-zoom-in" aria-label="Zoom in">+</button>
                    <button class="dominion-zoom-btn" id="dominion-zoom-out" aria-label="Zoom out">‚àí</button>
                </div>

                <!-- Directions Image (Top Right) -->
                <img src="/images/Dominion/directions.png" alt="Map Directions" class="dominion-directions" loading="lazy">

                <!-- Back Button -->
                <button id="dominion-back-btn" class="dominion-back-btn" aria-label="Return to home">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- PVE Screen -->
        <div id="pve-screen" class="game-screen hidden">
            <div class="pve-container">
                <!-- Battle Map Background -->
                <div class="pve-battle-map">
                    <!-- Monster Icons positioned on map -->
                    <button class="pve-monster-btn" id="pve-wood-dummy" data-monster="wood-dummy" style="left: calc(22% - 5px); top: calc(75% + 20px);">
                        <img src="/images/pve/wood-dummy.png" alt="Wood Dummy">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-raccoon" data-monster="raccoon" style="left: 13%; top: calc(35% + 50px);">
                        <img src="/images/pve/raccoon.png" alt="Raccoon">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-goblin" data-monster="goblin" style="left: calc(58% + 50px); top: calc(30% - 45px);">
                        <img src="/images/pve/goblin.png" alt="Goblin">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-ram" data-monster="ram" style="left: calc(35% - 45px); top: calc(25% - 25px);">
                        <img src="/images/pve/ram.png" alt="Ram">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-frog-fish" data-monster="frog-fish" style="left: calc(45% - 35px); top: calc(50% - 35px);">
                        <img src="/images/pve/frog-fish.png" alt="Frog-Fish">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-ripplefang" data-monster="ripplefang" style="left: calc(5% + 400px); top: 60%;">
                        <img src="/images/pve/serpent.png" alt="Ripplefang">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-nymph" data-monster="nymph" style="left: calc(82% + 40px); top: calc(35% + 60px);">
                        <img src="/images/pve/nymph.png" alt="Nymph">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-minitaur" data-monster="minitaur" style="left: calc(72% - 20px); top: calc(60% + 40px);">
                        <img src="/images/pve/minitaur.png" alt="Minitaur">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                    <button class="pve-monster-btn pve-locked" id="pve-dragon" data-monster="dragon" style="left: calc(88% + 10px); top: calc(15% + 10px);">
                        <img src="/images/pve/dragon.png" alt="Dragon">
                        <img src="/images/pve/lock.png" alt="Locked" class="pve-lock-icon">
                    </button>
                </div>

                <!-- Back Button -->
                <button id="pve-back-btn" class="pve-back-btn" aria-label="Return to home">
                    <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                </button>
            </div>
        </div>

        <!-- PVE Battle Screen -->
        <div id="pve-battle-screen" class="game-screen hidden">
        <div class="container">
            <!-- Left Side: Loot Container -->
            <div class="left-section">
                <div class="loot-container">
                    <div class="loot-header-top"></div>
                    <div class="loot-content">
                        <div id="pve-loot-box" class="treasure-chest">
                            <img src="/images/Loot/chest_shadow.png" alt="Chest Shadow" class="loot-chest-shadow" loading="lazy">
                            <img src="/images/Loot/chest_08.png" alt="Treasure Chest" class="loot-chest-image" loading="lazy">
                            <button id="pve-claim-loot-btn" class="claim-loot-btn hidden">CLAIM LOOT</button>
                        </div>
                    </div>
                    <div class="loot-header-bottom">WOOD CHEST<br>COMMON LOOT</div>
                </div>
            </div>

            <!-- Center: Battlefield Section -->
            <div class="battlefield-section">
                <button class="battlefield-fullscreen-close" aria-label="Exit fullscreen">‚úï</button>
                <div class="arena-viewport wood-castle" id="pve-arena-viewport">
                    <!-- Top Progress - Hero vs Monster -->
                    <div class="top-progress">
                        <!-- Hero HP Bar (Left) -->
                        <div class="hp-bar left-hp">
                            <div class="hp-bar-background"></div>
                            <div class="hp-bar-fill" id="pve-hero-hp-fill"></div>
                            <div class="hp-text" id="pve-hero-hp-text">10/10</div>
                        </div>

                        <!-- Win Odds Display (Center) -->
                        <div class="pve-win-odds" id="pve-win-odds">
                            <div class="win-odds-label">ODDS OF VICTORY</div>
                            <div class="win-odds-value" id="pve-win-odds-value">--</div>
                        </div>

                        <!-- Monster HP Bar (Right) -->
                        <div class="hp-bar right-hp">
                            <div class="hp-bar-background"></div>
                            <div class="hp-bar-fill" id="pve-monster-hp-fill"></div>
                            <div class="hp-text" id="pve-monster-hp-text">40/40</div>
                        </div>
                    </div>

                    <div class="battle-status" id="pve-battle-status"></div>
                    <div class="round-announcement" id="pve-round-announcement"></div>

                    <!-- Hero Fighter (Left) -->
                    <div class="fighter-left">
                        <div class="fighter-sprite left-sprite" id="pve-hero-sprite">
                        </div>
                    </div>

                    <!-- Monster Fighter (Right) -->
                    <div class="fighter-right">
                        <div class="fighter-sprite right-sprite" id="pve-monster-sprite">
                        </div>
                    </div>

                    <!-- Nameplates with VS -->
                    <div class="nameplate-vs-container">
                        <div class="nameplate left-nameplate">
                            <div class="nameplate-name" id="pve-hero-name">DARING HERO</div>
                            <div class="nameplate-titles" id="pve-hero-titles"></div>
                        </div>

                        <div class="vs-display">VS</div>

                        <div class="nameplate right-nameplate">
                            <div class="nameplate-name" id="pve-monster-name">WOOD DUMMY</div>
                            <div class="nameplate-titles" id="pve-monster-titles"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Side: Empty (no bracket) -->
            <div class="right-section pve-right-empty">
            </div>

            <!-- Bottom Left: Controls -->
            <div class="bottom-left-section">
                <div class="control-grid">
                    <button id="pve-settings-btn" class="control-btn" aria-label="Open settings">
                        <img src="/images/UX Images/settings.png" alt="Settings" class="icon-img">
                    </button>
                    <button id="pve-mute-audio" class="control-btn mute-btn" aria-label="Toggle audio">
                        <img src="/images/UX Images/Sound.png" alt="Sound" class="icon-img">
                    </button>
                    <button id="pve-exit-game" class="control-btn exit-btn" title="Return to PVE Map" aria-label="Return to PVE map">
                        <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                    </button>
                    <button id="pve-fast-forward" class="control-btn" aria-label="Fast forward">‚è©</button>
                </div>
            </div>

            <!-- Bottom Right: MAIN + Fullscreen Only -->
            <div class="bottom-right-section">
                <div class="view-grid pve-view-grid">
                    <button id="pve-main-view" class="view-btn">MAIN</button>
                    <button id="pve-fullscreen-btn" class="view-btn" aria-label="Fullscreen mode">‚õ∂</button>
                </div>
            </div>
        </div><!-- End container -->
        </div><!-- End pve-battle-screen -->

        <!-- PVP Screen -->
        <div id="pvp-screen" class="game-screen hidden">
            <div class="pvp-container">
                <!-- Background -->
                <div class="pvp-background"></div>

                <!-- Back Button -->
                <button id="pvp-back-btn" class="back-button" aria-label="Back to home">
                    <img src="/images/UX Images/back-arrow.png" alt="Back">
                </button>

                <!-- Legends Button (Left) -->
                <button id="pvp-legends-btn" class="pvp-mode-btn pvp-legends-btn" aria-label="Legends Mode">
                    <img src="/images/pvp/Legends.png" alt="Legends Mode">
                    <span class="coming-soon-badge">COMING SOON</span>
                </button>

                <!-- Tournament Button (Right) -->
                <button id="pvp-tournament-btn" class="pvp-mode-btn pvp-tournament-btn" aria-label="Tournament Mode">
                    <img src="/images/pvp/Tournament.png" alt="Tournament Mode">
                </button>
            </div>
        </div><!-- End pvp-screen -->

        <!-- Tournament Screen -->
        <div id="tournament-screen" class="game-screen hidden">
        <div class="container">
            <!-- Left Side: Loot Container -->
            <div class="left-section">
                <div class="loot-container">
                    <div class="loot-header-top"></div>
                    <div class="loot-content">
                        <div id="loot-box" class="treasure-chest">
                            <img src="/images/Loot/chest_shadow.png" alt="Chest Shadow" class="loot-chest-shadow" loading="lazy">
                            <img src="/images/Loot/chest_08.png" alt="Treasure Chest" class="loot-chest-image" loading="lazy">
                            <button id="claim-loot-btn" class="claim-loot-btn hidden">CLAIM LOOT</button>
                        </div>
                    </div>
                    <div class="loot-header-bottom">WOOD CHEST<br>COMMON LOOT</div>
                </div>
            </div>

            <!-- Center: Battlefield Section -->
            <div class="battlefield-section">
                <button class="battlefield-fullscreen-close" aria-label="Exit fullscreen">‚úï</button>
                <div class="arena-viewport castle">
                    <!-- Countdown Overlay -->
                    <div class="countdown-overlay" id="countdown-overlay">
                        <div class="countdown-timer" id="countdown-timer">00:00:10</div>
                    </div>

                    <!-- Top Tournament Progress -->
                    <div class="top-progress">
                        <!-- Left Fighter HP Bar -->
                        <div class="hp-bar left-hp">
                            <div class="hp-bar-background"></div>
                            <div class="hp-bar-fill" id="left-hp-fill"></div>
                            <div class="hp-text" id="left-hp-text">10/10</div>
                        </div>

                        <div class="progress-container">
                            <div class="progress-label">Tournament Progress</div>
                            <div class="progress-bar">
                                <div class="progress-segments" id="progress-segments"></div>
                                <div class="hero-progress-indicator" id="hero-progress-indicator">‚ñ≤</div>
                            </div>
                        </div>

                        <!-- Right Fighter HP Bar -->
                        <div class="hp-bar right-hp">
                            <div class="hp-bar-background"></div>
                            <div class="hp-bar-fill" id="right-hp-fill"></div>
                            <div class="hp-text" id="right-hp-text">10/10</div>
                        </div>
                    </div>

                    <!-- Top Odds Display -->
                    <div class="top-odds">
                        <div class="odds-display">
                            <span class="odds-label">odds:</span>
                            <span class="crown-odds">1 in 16,384</span>
                        </div>
                    </div>
                    <div class="battle-status"></div>
                    <div class="round-announcement"></div>
                    <div class="fighter-left">
                        <div class="fighter-sprite left-sprite">
                        </div>
                    </div>

                    <div class="fighter-right">
                        <div class="fighter-sprite right-sprite">
                        </div>
                    </div>

                    <!-- Corner to Center Nameplates with VS -->
                    <div class="nameplate-vs-container">
                        <div class="nameplate left-nameplate">
                            <div class="nameplate-name" id="left-nameplate-name"></div>
                            <div class="nameplate-titles" id="left-nameplate-titles"></div>
                        </div>

                        <div class="vs-display">VS</div>

                        <div class="nameplate right-nameplate">
                            <div class="nameplate-name" id="right-nameplate-name"></div>
                            <div class="nameplate-titles" id="right-nameplate-titles"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Side: Battle Emojis -->
            <div class="right-section">
                <div class="emoji-panel">
                    <div class="emoji-header"></div>
                    <div class="emoji-grid">
                        <button class="emoji-btn" data-emoji="‚öîÔ∏è">‚öîÔ∏è</button>
                        <button class="emoji-btn" data-emoji="üõ°Ô∏è">üõ°Ô∏è</button>
                        <button class="emoji-btn" data-emoji="üí•">üí•</button>
                        <button class="emoji-btn" data-emoji="üî•">üî•</button>
                        <button class="emoji-btn" data-emoji="‚ö°">‚ö°</button>
                        <button class="emoji-btn" data-emoji="üíÄ">üíÄ</button>
                        <button class="emoji-btn" data-emoji="üëë">üëë</button>
                        <button class="emoji-btn" data-emoji="üèÜ">üèÜ</button>
                        <button class="emoji-btn" data-emoji="üí™">üí™</button>
                        <button class="emoji-btn" data-emoji="üéØ">üéØ</button>
                    </div>
                </div>
            </div>

            <!-- Bottom Left: 4-Button Control Grid -->
            <div class="bottom-left-section">
                <div class="control-grid">
                    <button id="settings-btn" class="control-btn" aria-label="Open settings">
                        <img src="/images/UX Images/settings.png" alt="Settings" class="icon-img">
                    </button>
                    <button id="mute-audio" class="control-btn mute-btn" aria-label="Toggle audio">
                        <img src="/images/UX Images/Sound.png" alt="Sound" class="icon-img">
                    </button>
                    <button id="exit-game" class="control-btn exit-btn" title="Return to Home" aria-label="Return to home">
                        <img src="/images/UX Images/back-arrow.png" alt="Back" class="icon-img">
                    </button>
                    <label class="control-btn toggle-btn" aria-label="Enable Daring Hero mode">
                        <input type="checkbox" id="daring-hero-checkbox">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Bottom Center: Chat -->
            <div class="bottom-section">
                <div class="chat-container">
                    <div class="chat-content" id="chat-content">
                        <div class="chat-messages" id="chat-messages">
                            <div class="chat-message system">Welcome to RNG Arena!</div>
                            <div class="chat-message system">Start the tournament to begin...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Right: 4-Button View Grid -->
            <div class="bottom-right-section">
                <div class="view-grid">
                    <button id="chat-mode" class="view-btn">LIVE<br>CHAT</button>
                    <button id="bracket-mode" class="view-btn">BRACKET</button>
                    <button id="fullscreen-btn" class="view-btn" aria-label="Fullscreen mode">‚õ∂</button>
                    <button class="view-btn shield-btn" aria-label="Shield protection">üõ°Ô∏è</button>
                </div>
            </div>
        </div><!-- End container -->
        </div><!-- End tournament-screen -->

        <!-- Loot Claim Popup Overlay -->
        <div class="loot-claim-overlay hidden" id="loot-claim-overlay">
            <div class="loot-claim-viewport">
                <div class="popup-loot-container">
                    <div class="popup-loot-header-top"></div>
                    <div class="popup-loot-display">
                        <div id="popup-loot-box" class="popup-treasure-chest">
                            <img src="/images/Loot/chest_08.png" alt="Treasure Chest" class="popup-loot-chest-image" loading="lazy">
                        </div>
                    </div>
                    <div class="popup-loot-header-bottom">WOOD CHEST<br>COMMON LOOT</div>
                </div>
            </div>
        </div>

        <!-- Tournament Bracket Overlay -->
        <div id="bracket-overlay" class="bracket-overlay hidden">
            <div class="bracket-overlay-background"></div>
            <div class="bracket-overlay-content">
                <div class="bracket-container">
                    <div class="bracket-header">
                        <span>TOURNAMENT BRACKET</span>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="bracket-zoom-controls">
                                <button id="overlay-zoom-out" class="zoom-btn" aria-label="Zoom out">-</button>
                                <span id="overlay-zoom-level">100%</span>
                                <button id="overlay-zoom-in" class="zoom-btn" aria-label="Zoom in">+</button>
                            </div>
                            <button id="close-bracket" class="close-bracket-btn" aria-label="Close bracket">‚úï</button>
                        </div>
                    </div>
                    <div class="bracket-content">
                        <div class="bracket-viewport">
                            <div id="overlay-bracket-display" class="bracket-display"></div>
                        </div>
                        <div class="bracket-slider-container">
                            <input type="range" id="overlay-bracket-slider" class="bracket-slider" min="0" max="100" value="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Chat Overlay -->
        <div id="chat-mode-overlay" class="chat-mode-overlay hidden">
            <div class="chat-mode-overlay-content">
                <!-- Top Control Bar -->
                <div class="chat-mode-top-bar">
                    <button id="chat-mode-settings-btn" class="chat-mode-control-btn" aria-label="Open settings">
                        <img src="/images/UX Images/settings.png" alt="Settings" class="icon-img">
                    </button>
                    <button id="chat-mode-mute-btn" class="chat-mode-control-btn" aria-label="Toggle audio">
                        <img src="/images/UX Images/Sound.png" alt="Sound" class="icon-img">
                    </button>
                    <button class="chat-mode-control-btn chat-mode-close-btn" id="close-chat-mode-overlay" aria-label="Close live chat">‚úï</button>
                </div>
                <div class="chat-mode-battlefield-overlay" id="chat-mode-battlefield-overlay">
                    <!-- Battlefield will be cloned here -->
                </div>
                <div class="chat-mode-messages-overlay" id="chat-mode-messages-overlay">
                    <div class="chat-mode-message system">Welcome to Live Chat!</div>
                    <div class="chat-mode-message system">Messages will appear here during battles...</div>
                </div>
                <div class="chat-mode-input-container-overlay">
                    <input type="text" class="chat-mode-input" id="chat-mode-input-overlay" placeholder="Type a message...">
                    <button class="chat-mode-send-btn" id="chat-mode-send-btn-overlay">SEND</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Dev Panel -->
    <div class="dev-panel-title">DEV PANEL</div>
    <div class="dev-toggle-container">
        <button id="start-tournament-btn" class="start-tournament-btn" aria-label="Start PVP tournament">üèÜ START TOURNAMENT</button>
        <button id="fast-forward-btn" class="fast-forward-btn" aria-label="Toggle 4x fast forward">‚è© 4x Fast Forward</button>
        <button id="dev-preview-toggle" class="dev-preview-toggle-btn" aria-label="Toggle dev previews">‚ñº Show Dev Previews</button>
        <button id="dev-mute-btn" class="dev-mute-btn active" aria-label="Toggle audio mute">
            <img src="/images/UX Images/Sound.png" alt="Sound" class="icon-img"> UNMUTED
        </button>
        <button id="pve-dev-unlock" class="pve-dev-unlock" aria-label="Dev Mode: Unlock All PVE Monsters" title="Unlock all PVE monsters for testing">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            UNLOCK PVE
        </button>
    </div>

    <!-- Dev Preview Wrapper -->
    <div id="dev-preview-wrapper" class="dev-preview-wrapper hidden">
        <!-- Dev Frame Tabs -->
        <div class="dev-tabs-container">
            <button class="dev-tab active" data-tab="bracket">üìä Bracket</button>
            <button class="dev-tab" data-tab="loot">üéÅ Loot</button>
            <button class="dev-tab" data-tab="chat">üí¨ Live Chat</button>
            <button class="dev-tab" data-tab="battlepass">üé´ Battle Pass</button>
        </div>

        <!-- Bracket Development Frame -->
        <div class="bracket-dev-frame dev-frame-tab" data-frame="bracket">
        <div class="bracket-container-dev">
            <div class="bracket-container">
                <div class="bracket-header" id="bracket-toggle">
                    <span>TOURNAMENT BRACKET</span>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div class="bracket-zoom-controls">
                            <button id="zoom-out" class="zoom-btn" aria-label="Zoom out">-</button>
                            <span id="zoom-level">100%</span>
                            <button id="zoom-in" class="zoom-btn" aria-label="Zoom in">+</button>
                        </div>
                        <span class="accordion-toggle">‚ñº</span>
                    </div>
                </div>
                <div class="bracket-content" id="bracket-content">
                    <div class="bracket-viewport">
                        <div id="bracket-display" class="bracket-display"></div>
                    </div>
                    <div class="bracket-slider-container">
                        <input type="range" id="bracket-slider" class="bracket-slider" min="0" max="100" value="0">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loot Claim Preview Frame -->
    <div class="loot-claim-dev-frame dev-frame-tab hidden" data-frame="loot">
        <div class="loot-claim-container-dev">
            <div class="loot-claim-viewport-dev">
                <div class="dev-loot-container">
                    <div class="dev-loot-header-top"></div>
                    <div class="dev-loot-display">
                        <div id="dev-loot-box" class="dev-treasure-chest">
                            <img src="/images/Loot/chest_08.png" alt="Treasure Chest" class="dev-loot-chest-image" loading="lazy">
                        </div>
                    </div>
                    <div class="dev-loot-header-bottom">WOOD CHEST<br>COMMON LOOT</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Live Chat Preview Frame -->
    <div class="chat-mode-dev-frame dev-frame-tab hidden" id="chat-mode-frame" data-frame="chat">
        <button class="chat-mode-close-btn" id="close-chat-mode" aria-label="Close live chat">‚úï</button>
        <div class="chat-mode-container-dev">
            <div class="chat-mode-viewport-dev">
                <!-- Top: Battlefield Clone -->
                <div class="chat-mode-battlefield" id="chat-mode-battlefield">
                    <!-- Battlefield will be cloned here -->
                </div>

                <!-- Middle: Chat Messages -->
                <div class="chat-mode-messages" id="chat-mode-messages">
                    <div class="chat-mode-message system">Welcome to Live Chat!</div>
                    <div class="chat-mode-message system">Messages will appear here during battles...</div>
                </div>

                <!-- Bottom: Chat Input -->
                <div class="chat-mode-input-container">
                    <input type="text" class="chat-mode-input" id="chat-mode-input" placeholder="Type a message...">
                    <button class="chat-mode-send-btn" id="chat-mode-send-btn">SEND</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Battle Pass Development Frame -->
    <div class="battlepass-dev-frame dev-frame-tab hidden" data-frame="battlepass">
        <div class="battlepass-dev-container">
            <div class="battlepass-dev-background"></div>
            <button class="battlepass-dev-close-btn" aria-label="Close Battle Pass">‚úï</button>
            <img src="/images/Home Screen/battle-pass.png" alt="Battle Pass" class="battlepass-dev-image" loading="lazy">
        </div>
    </div>
    </div><!-- End dev-preview-wrapper -->

    <!-- Game Scripts - ES6 Modules -->
    <script src="./tournament.js"></script>
    <script type="module">
        // Import all game systems
        import { RNGArena } from './js/RNGArena.js';
        import { GAME_CONFIG } from './js/constants.js';

        // Make GAME_CONFIG globally accessible for fast forward button
        window.GAME_CONFIG = GAME_CONFIG;

        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Loading Screen Logic
            const loadingScreen = document.getElementById('loading-screen');
            const homeScreen = document.getElementById('home-screen');
            const loadingBarFill = document.getElementById('loading-bar-fill');
            const startBtn = document.getElementById('start-btn');
            const loadingBar = document.querySelector('.loading-bar-container');

            console.log('üéÆ Loading screen elements:', { loadingScreen, loadingBarFill, startBtn, loadingBar });

            if (!loadingBarFill) {
                console.error('‚ùå Loading bar fill element not found!');
                return;
            }

            // Animate loading bar over 2.5 seconds
            let progress = 0;
            const duration = 2500; // 2.5 seconds
            const interval = 25; // Update every 25ms
            const increment = (100 / duration) * interval;

            const loadingInterval = setInterval(() => {
                progress += increment;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(loadingInterval);

                    // Hide loading bar and show start button
                    setTimeout(() => {
                        if (loadingBar) loadingBar.style.opacity = '0';
                        setTimeout(() => {
                            if (loadingBar) loadingBar.style.display = 'none';
                            if (startBtn) startBtn.classList.remove('hidden');
                        }, 300);
                    }, 200);
                }
                loadingBarFill.style.width = progress + '%';
            }, interval);

            // Reset cloud animation seamlessly before it completes to avoid dark seam
            // Reset at 50s if the dark gap appears around 60s
            const resetCloudAnimation = () => {
                const clouds = loadingScreen.querySelector('.parallax-clouds');
                if (clouds && !loadingScreen.classList.contains('hidden')) {
                    // Force animation restart by toggling a class
                    clouds.classList.add('reset-animation');
                    // Trigger reflow
                    void clouds.offsetHeight;
                    // Remove class to restart animation
                    clouds.classList.remove('reset-animation');
                }
            };

            // Reset animation every 50 seconds to avoid dark seam
            let cloudResetInterval = setInterval(() => {
                if (loadingScreen.classList.contains('hidden')) {
                    clearInterval(cloudResetInterval);
                } else {
                    resetCloudAnimation();
                }
            }, 50000);

            // Start button click handler
            startBtn.addEventListener('click', () => {
                clearInterval(cloudResetInterval);
                loadingScreen.classList.add('hidden');
                homeScreen.classList.remove('hidden');
            });

            // Initialize audio as muted on loading screen only
            const homeMusic = document.getElementById('home-music');
            homeMusic.muted = true;

            // Loading screen mute button functionality
            const muteBtn = document.getElementById('mute-btn');
            const devMuteBtn = document.getElementById('dev-mute-btn');
            let loadingScreenMuted = true; // Loading screen starts muted (global default is unmuted)

            if (muteBtn) {
                muteBtn.addEventListener('click', () => {
                    loadingScreenMuted = !loadingScreenMuted;
                    homeMusic.muted = loadingScreenMuted;
                    const muteBtnImg = muteBtn.querySelector('.icon-img');
                    if (muteBtnImg) {
                        muteBtnImg.src = loadingScreenMuted ? '/images/UX Images/sound-off.png' : '/images/UX Images/Sound.png';
                        muteBtnImg.alt = loadingScreenMuted ? 'Muted' : 'Sound';
                    }

                    // Update dev button too (loading screen only controls homeMusic directly)
                    if (devMuteBtn) {
                        const devMuteBtnImg = devMuteBtn.querySelector('.icon-img');
                        if (devMuteBtnImg) {
                            devMuteBtnImg.src = loadingScreenMuted ? '/images/UX Images/sound-off.png' : '/images/UX Images/Sound.png';
                            devMuteBtnImg.alt = loadingScreenMuted ? 'Muted' : 'Sound';
                        }
                        devMuteBtn.innerHTML = loadingScreenMuted ?
                            '<img src="/images/UX Images/sound-off.png" alt="Muted" class="icon-img"> MUTED' :
                            '<img src="/images/UX Images/Sound.png" alt="Sound" class="icon-img"> UNMUTED';
                        devMuteBtn.classList.toggle('active', !loadingScreenMuted);
                    }

                    // Ensure audio plays when unmuted
                    if (!loadingScreenMuted) {
                        homeMusic.play().catch(err => {
                            console.log('Audio play prevented:', err);
                        });
                    }
                });
            }

            // Dev Preview Toggle functionality
            const toggleBtn = document.getElementById('dev-preview-toggle');
            const previewWrapper = document.getElementById('dev-preview-wrapper');

            if (toggleBtn && previewWrapper) {
                toggleBtn.addEventListener('click', () => {
                    const isHidden = previewWrapper.classList.toggle('hidden');
                    toggleBtn.textContent = isHidden ? '‚ñº Show Dev Previews' : '‚ñ≤ Hide Dev Previews';
                });
            }

            // Fast Forward 4x functionality
            const fastForwardBtn = document.getElementById('fast-forward-btn');
            let isFastForward = false;

            if (fastForwardBtn) {
                fastForwardBtn.addEventListener('click', () => {
                    isFastForward = !isFastForward;
                    fastForwardBtn.classList.toggle('active');
                    fastForwardBtn.textContent = isFastForward ? '‚è∏Ô∏è Normal Speed' : '‚è© 4x Fast Forward';

                    // Update GAME_CONFIG timing values
                    if (window.GAME_CONFIG && window.GAME_CONFIG.TIMING) {
                        const multiplier = isFastForward ? 0.25 : 4;
                        window.GAME_CONFIG.TIMING.TURN_DELAY = Math.round(window.GAME_CONFIG.TIMING.TURN_DELAY * multiplier);
                        window.GAME_CONFIG.TIMING.END_OF_ROUND_DELAY = Math.round(window.GAME_CONFIG.TIMING.END_OF_ROUND_DELAY * multiplier);

                        console.log('‚è© Fast forward', isFastForward ? 'ENABLED (4x)' : 'DISABLED (1x)');
                        console.log('   Turn delay:', window.GAME_CONFIG.TIMING.TURN_DELAY, 'ms');
                    }
                });
            }

            // Dev Panel Mute Button
            // During loading screen: controls homeMusic directly
            // After arena loads: calls window.arena.toggleMute() for global control
            if (devMuteBtn) {
                devMuteBtn.addEventListener('click', () => {
                    // Check if arena is loaded (after loading screen)
                    if (window.arena && window.arena.toggleMute) {
                        // Use arena's global mute control
                        window.arena.toggleMute();
                    } else {
                        // Loading screen: control homeMusic directly
                        loadingScreenMuted = !loadingScreenMuted;
                        homeMusic.muted = loadingScreenMuted;

                        // Update both buttons
                        devMuteBtn.innerHTML = loadingScreenMuted ?
                            '<img src="/images/UX Images/sound-off.png" alt="Muted" class="icon-img"> MUTED' :
                            '<img src="/images/UX Images/Sound.png" alt="Sound" class="icon-img"> UNMUTED';
                        devMuteBtn.classList.toggle('active', !loadingScreenMuted);
                        if (muteBtn) {
                            const muteBtnImg = muteBtn.querySelector('.icon-img');
                            if (muteBtnImg) {
                                muteBtnImg.src = loadingScreenMuted ? '/images/UX Images/sound-off.png' : '/images/UX Images/Sound.png';
                                muteBtnImg.alt = loadingScreenMuted ? 'Muted' : 'Sound';
                            }
                        }

                        // Try to play if unmuting
                        if (!loadingScreenMuted) {
                            homeMusic.play().catch(err => {
                                console.log('Audio play prevented:', err);
                            });
                        }
                    }
                });
            }

            setTimeout(() => {
                try {
                    const arena = new RNGArena();
                    window.arena = arena; // For debugging
                } catch (error) {
                    console.error('Arena creation failed:', error);
                    alert('Arena failed: ' + error.message);
                }
            }, 500);
        });

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // Global Error Handlers - Catch unhandled errors and rejections
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        // Handle uncaught JavaScript errors
        window.addEventListener('error', (event) => {
            console.error('üö® Uncaught Error:', {
                message: event.message,
                filename: event.filename,
                line: event.lineno,
                column: event.colno,
                error: event.error,
                stack: event.error?.stack
            });

            // In production, you would send this to a logging service like Sentry
            // For now, we just log to console in dev mode
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                // Development mode - show in console (already logged above)
            } else {
                // Production mode - send to logging service
                // sendToLoggingService(errorData);
            }

            // Prevent default browser error handling
            // Remove this line if you want browser to also show errors
            // event.preventDefault();
        });

        // Handle unhandled promise rejections
        window.addEventListener('unhandledrejection', (event) => {
            console.error('üö® Unhandled Promise Rejection:', {
                reason: event.reason,
                promise: event.promise,
                stack: event.reason?.stack
            });

            // In production, you would send this to a logging service
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                // Development mode - show in console (already logged above)
            } else {
                // Production mode - send to logging service
                // sendToLoggingService(rejectionData);
            }

            // Prevent default browser handling
            // event.preventDefault();
        });

        // Optional: Handle handled rejections that might still be useful to log
        window.addEventListener('rejectionhandled', (event) => {
            console.log('‚ÑπÔ∏è Promise rejection handled (late):', event.reason);
        });

        console.log('‚úÖ Global error handlers initialized');
    </script>

</body>
</html>